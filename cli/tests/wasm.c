#include <stdbool.h> // bool
#include <string.h> // memcpy()
#include <stdio.h> // snprintf()
#include <float.h> // FLT_EPSILON, DBL_EPSILON
#include "../tests.h"
#include "../../pwasm.h"

#define LEN(ary) (sizeof(ary) / sizeof(ary[0]))

// maximum test stack depth
#define MAX_STACK_DEPTH 100

// are two floats/doubles approximately equal?
#define NEARLY_EQUAL(a, b) (((a) - 0.00001 <= (b)) && ((a) + 0.00001 >= (b)))

// test module with one func "life" (void -> i32)
static const uint8_t GUIDE_WASM[] = {
  0x00, 0x61, 0x73, 0x6d, 0x01, 0x00, 0x00, 0x00,
  0x01, 0x05, 0x01, 0x60, 0x00, 0x01, 0x7f, 0x03,
  0x02, 0x01, 0x00, 0x07, 0x08, 0x01, 0x04, 0x6c,
  0x69, 0x66, 0x65, 0x00, 0x00, 0x0a, 0x09, 0x01,
  0x07, 0x00, 0x41, 0x0e, 0x41, 0x03, 0x6c, 0x0b
};

// pythag.wasm: test module with two functions:
// * f32.pythag(f32, f32) -> f32
// * f64.pythag(f64, f64) -> f64
static const uint8_t PYTHAG_WASM[] = {
  0x00, 0x61, 0x73, 0x6d, 0x01, 0x00, 0x00, 0x00,
  0x01, 0x0D, 0x02, 0x60, 0x02, 0x7D, 0x7D, 0x01,
  0x7D, 0x60, 0x02, 0x7C, 0x7C, 0x01, 0x7C, 0x03,
  0x03, 0x02, 0x00, 0x01, 0x07, 0x1B, 0x02, 0x0A,
  'f',  '3',  '2',  '.',  'p',  'y',  't',  'h',
  'a',  'g',  0x00, 0x00, 0x0A, 'f',  '6',  '4',
  '.',  'p',  'y',  't',  'h',  'a',  'g',  0x00,
  0x01, 0x0A, 0x1F, 0x02, 0x0E, 0x00, 0x20, 0x00,
  0x20, 0x00, 0x94, 0x20, 0x01, 0x20, 0x01, 0x94,
  0x92, 0x91, 0x0B, 0x0E, 0x00, 0x20, 0x00, 0x20,
  0x00, 0xA2, 0x20, 0x01, 0x20, 0x01, 0xA2, 0xA0,
  0x9F, 0x0B,
};

// fib.wasm: test module with two functions:
// - fib_recurse(i32) -> i32
// - fib_iterate(i32) -> i32
//
// (source: data/wat/01-fib.wat)
static const uint8_t FIB_WASM[] = {
  0x00, 0x61, 0x73, 0x6d, 0x01, 0x00, 0x00, 0x00,
  0x01, 0x06, 0x01, 0x60, 0x01, 0x7f, 0x01, 0x7f,
  0x03, 0x03, 0x02, 0x00, 0x00, 0x07, 0x1d, 0x02,
  0x0b, 0x66, 0x69, 0x62, 0x5f, 0x72, 0x65, 0x63,
  0x75, 0x72, 0x73, 0x65, 0x00, 0x00, 0x0b, 0x66,
  0x69, 0x62, 0x5f, 0x69, 0x74, 0x65, 0x72, 0x61,
  0x74, 0x65, 0x00, 0x01, 0x0a, 0x56, 0x02, 0x1c,
  0x00, 0x20, 0x00, 0x41, 0x02, 0x49, 0x04, 0x7f,
  0x20, 0x00, 0x05, 0x20, 0x00, 0x41, 0x02, 0x6b,
  0x10, 0x00, 0x20, 0x00, 0x41, 0x01, 0x6b, 0x10,
  0x00, 0x6a, 0x0b, 0x0b, 0x37, 0x01, 0x02, 0x7f,
  0x20, 0x00, 0x41, 0x02, 0x49, 0x04, 0x7f, 0x20,
  0x00, 0x05, 0x20, 0x00, 0x41, 0x01, 0x6b, 0x21,
  0x00, 0x41, 0x00, 0x21, 0x02, 0x41, 0x01, 0x21,
  0x01, 0x03, 0x7f, 0x20, 0x01, 0x20, 0x01, 0x20,
  0x02, 0x6a, 0x21, 0x01, 0x21, 0x02, 0x20, 0x00,
  0x41, 0x01, 0x6b, 0x22, 0x00, 0x0d, 0x00, 0x20,
  0x01, 0x0b, 0x0b, 0x0b
};

// fib.wasm: test module with several vector functions and a memory
// export.
//
// (source: data/wat/02-vec.wat)
static const uint8_t VEC_WASM[] = {
  0x00, 0x61, 0x73, 0x6d, 0x01, 0x00, 0x00, 0x00,
  0x01, 0x35, 0x08, 0x60, 0x03, 0x7f, 0x7f, 0x7f,
  0x01, 0x7f, 0x60, 0x03, 0x7f, 0x7d, 0x7d, 0x01,
  0x7f, 0x60, 0x01, 0x7f, 0x01, 0x7d, 0x60, 0x02,
  0x7f, 0x7d, 0x01, 0x7f, 0x60, 0x01, 0x7f, 0x01,
  0x7f, 0x60, 0x02, 0x7f, 0x7f, 0x01, 0x7d, 0x60,
  0x04, 0x7f, 0x7d, 0x7d, 0x7d, 0x01, 0x7f, 0x60,
  0x04, 0x7d, 0x7d, 0x7d, 0x7d, 0x01, 0x7d, 0x03,
  0x11, 0x10, 0x00, 0x01, 0x02, 0x03, 0x04, 0x05,
  0x00, 0x00, 0x06, 0x02, 0x03, 0x04, 0x05, 0x00,
  0x00, 0x07, 0x05, 0x03, 0x01, 0x00, 0x01, 0x07,
  0xa3, 0x01, 0x11, 0x03, 0x6d, 0x65, 0x6d, 0x02,
  0x00, 0x07, 0x76, 0x32, 0x2e, 0x63, 0x6f, 0x70,
  0x79, 0x00, 0x00, 0x08, 0x76, 0x32, 0x2e, 0x73,
  0x74, 0x6f, 0x72, 0x65, 0x00, 0x01, 0x06, 0x76,
  0x32, 0x2e, 0x6d, 0x61, 0x67, 0x00, 0x02, 0x06,
  0x76, 0x32, 0x2e, 0x6d, 0x75, 0x6c, 0x00, 0x03,
  0x07, 0x76, 0x32, 0x2e, 0x6e, 0x6f, 0x72, 0x6d,
  0x00, 0x04, 0x06, 0x76, 0x32, 0x2e, 0x64, 0x6f,
  0x74, 0x00, 0x05, 0x07, 0x76, 0x32, 0x2e, 0x70,
  0x72, 0x6f, 0x6a, 0x00, 0x06, 0x07, 0x76, 0x33,
  0x2e, 0x63, 0x6f, 0x70, 0x79, 0x00, 0x07, 0x08,
  0x76, 0x33, 0x2e, 0x73, 0x74, 0x6f, 0x72, 0x65,
  0x00, 0x08, 0x06, 0x76, 0x33, 0x2e, 0x6d, 0x61,
  0x67, 0x00, 0x09, 0x06, 0x76, 0x33, 0x2e, 0x6d,
  0x75, 0x6c, 0x00, 0x0a, 0x07, 0x76, 0x33, 0x2e,
  0x6e, 0x6f, 0x72, 0x6d, 0x00, 0x0b, 0x06, 0x76,
  0x33, 0x2e, 0x64, 0x6f, 0x74, 0x00, 0x0c, 0x07,
  0x76, 0x33, 0x2e, 0x70, 0x72, 0x6f, 0x6a, 0x00,
  0x0d, 0x08, 0x76, 0x33, 0x2e, 0x63, 0x72, 0x6f,
  0x73, 0x73, 0x00, 0x0e, 0x06, 0x6d, 0x32, 0x2e,
  0x64, 0x65, 0x74, 0x00, 0x0f, 0x0a, 0x93, 0x05,
  0x10, 0x33, 0x01, 0x02, 0x7f, 0x20, 0x02, 0x41,
  0x08, 0x6c, 0x21, 0x04, 0x02, 0x40, 0x03, 0x40,
  0x20, 0x03, 0x20, 0x04, 0x46, 0x0d, 0x01, 0x20,
  0x00, 0x20, 0x03, 0x6a, 0x20, 0x01, 0x20, 0x03,
  0x6a, 0x29, 0x03, 0x00, 0x37, 0x03, 0x00, 0x20,
  0x03, 0x41, 0x08, 0x6a, 0x21, 0x03, 0x0c, 0x00,
  0x0b, 0x0b, 0x20, 0x00, 0x0b, 0x12, 0x00, 0x20,
  0x00, 0x20, 0x01, 0x38, 0x02, 0x00, 0x20, 0x00,
  0x20, 0x02, 0x38, 0x02, 0x04, 0x20, 0x00, 0x0b,
  0x1e, 0x01, 0x02, 0x7d, 0x20, 0x00, 0x2a, 0x02,
  0x00, 0x21, 0x01, 0x20, 0x00, 0x2a, 0x02, 0x04,
  0x21, 0x02, 0x20, 0x01, 0x20, 0x01, 0x94, 0x20,
  0x02, 0x20, 0x02, 0x94, 0x92, 0x91, 0x0b, 0x20,
  0x01, 0x02, 0x7d, 0x20, 0x01, 0x20, 0x00, 0x2a,
  0x02, 0x00, 0x94, 0x21, 0x02, 0x20, 0x01, 0x20,
  0x00, 0x2a, 0x02, 0x04, 0x94, 0x21, 0x03, 0x20,
  0x00, 0x20, 0x02, 0x20, 0x03, 0x10, 0x01, 0x0b,
  0x2e, 0x01, 0x03, 0x7d, 0x20, 0x00, 0x2a, 0x02,
  0x00, 0x21, 0x02, 0x20, 0x00, 0x2a, 0x02, 0x04,
  0x21, 0x03, 0x20, 0x00, 0x10, 0x02, 0x21, 0x01,
  0x20, 0x02, 0x20, 0x01, 0x95, 0x21, 0x02, 0x20,
  0x03, 0x20, 0x01, 0x95, 0x21, 0x03, 0x20, 0x00,
  0x20, 0x02, 0x20, 0x03, 0x10, 0x01, 0x0b, 0x19,
  0x00, 0x20, 0x00, 0x2a, 0x02, 0x00, 0x20, 0x01,
  0x2a, 0x02, 0x00, 0x94, 0x20, 0x00, 0x2a, 0x02,
  0x04, 0x20, 0x01, 0x2a, 0x02, 0x04, 0x94, 0x92,
  0x0b, 0x34, 0x01, 0x04, 0x7d, 0x20, 0x02, 0x10,
  0x02, 0x21, 0x03, 0x20, 0x01, 0x20, 0x02, 0x10,
  0x05, 0x20, 0x03, 0x20, 0x03, 0x94, 0x95, 0x21,
  0x04, 0x20, 0x04, 0x20, 0x02, 0x2a, 0x02, 0x00,
  0x94, 0x21, 0x05, 0x20, 0x04, 0x20, 0x02, 0x2a,
  0x02, 0x04, 0x94, 0x21, 0x06, 0x20, 0x00, 0x20,
  0x05, 0x20, 0x06, 0x10, 0x01, 0x0b, 0x5c, 0x03,
  0x01, 0x7f, 0x03, 0x7d, 0x01, 0x7f, 0x20, 0x00,
  0x21, 0x07, 0x02, 0x40, 0x03, 0x40, 0x20, 0x03,
  0x20, 0x02, 0x46, 0x0d, 0x01, 0x20, 0x01, 0x2a,
  0x02, 0x00, 0x21, 0x04, 0x20, 0x01, 0x2a, 0x02,
  0x04, 0x21, 0x05, 0x20, 0x01, 0x2a, 0x02, 0x08,
  0x21, 0x05, 0x20, 0x00, 0x20, 0x04, 0x38, 0x02,
  0x00, 0x20, 0x00, 0x20, 0x05, 0x38, 0x02, 0x04,
  0x20, 0x00, 0x20, 0x06, 0x38, 0x02, 0x08, 0x20,
  0x03, 0x41, 0x01, 0x6a, 0x21, 0x03, 0x20, 0x00,
  0x41, 0x0c, 0x6a, 0x21, 0x00, 0x20, 0x00, 0x41,
  0x0c, 0x6a, 0x21, 0x01, 0x0c, 0x00, 0x0b, 0x0b,
  0x20, 0x00, 0x0b, 0x19, 0x00, 0x20, 0x00, 0x20,
  0x01, 0x38, 0x02, 0x00, 0x20, 0x00, 0x20, 0x02,
  0x38, 0x02, 0x04, 0x20, 0x00, 0x20, 0x03, 0x38,
  0x02, 0x08, 0x20, 0x00, 0x0b, 0x2b, 0x01, 0x03,
  0x7d, 0x20, 0x00, 0x2a, 0x02, 0x00, 0x21, 0x01,
  0x20, 0x00, 0x2a, 0x02, 0x04, 0x21, 0x02, 0x20,
  0x00, 0x2a, 0x02, 0x08, 0x21, 0x03, 0x20, 0x01,
  0x20, 0x01, 0x94, 0x20, 0x02, 0x20, 0x02, 0x94,
  0x92, 0x20, 0x03, 0x20, 0x03, 0x94, 0x92, 0x91,
  0x0b, 0x1e, 0x00, 0x20, 0x00, 0x20, 0x01, 0x20,
  0x00, 0x2a, 0x02, 0x00, 0x94, 0x20, 0x01, 0x20,
  0x00, 0x2a, 0x02, 0x04, 0x94, 0x20, 0x01, 0x20,
  0x00, 0x2a, 0x02, 0x08, 0x94, 0x10, 0x08, 0x0b,
  0x10, 0x00, 0x20, 0x00, 0x43, 0x00, 0x00, 0x80,
  0x3f, 0x20, 0x00, 0x10, 0x09, 0x95, 0x10, 0x0a,
  0x0b, 0x25, 0x00, 0x20, 0x00, 0x2a, 0x02, 0x00,
  0x20, 0x01, 0x2a, 0x02, 0x00, 0x94, 0x20, 0x00,
  0x2a, 0x02, 0x04, 0x20, 0x01, 0x2a, 0x02, 0x04,
  0x94, 0x92, 0x20, 0x00, 0x2a, 0x02, 0x08, 0x20,
  0x01, 0x2a, 0x02, 0x08, 0x94, 0x92, 0x0b, 0x34,
  0x01, 0x02, 0x7d, 0x20, 0x02, 0x10, 0x09, 0x21,
  0x03, 0x20, 0x01, 0x20, 0x02, 0x10, 0x0c, 0x20,
  0x03, 0x20, 0x03, 0x94, 0x95, 0x21, 0x04, 0x20,
  0x00, 0x20, 0x04, 0x20, 0x02, 0x2a, 0x02, 0x00,
  0x94, 0x20, 0x04, 0x20, 0x02, 0x2a, 0x02, 0x04,
  0x94, 0x20, 0x04, 0x20, 0x02, 0x2a, 0x02, 0x08,
  0x94, 0x10, 0x08, 0x0b, 0x50, 0x01, 0x06, 0x7d,
  0x20, 0x01, 0x2a, 0x02, 0x00, 0x21, 0x03, 0x20,
  0x01, 0x2a, 0x02, 0x04, 0x21, 0x04, 0x20, 0x01,
  0x2a, 0x02, 0x08, 0x21, 0x05, 0x20, 0x02, 0x2a,
  0x02, 0x00, 0x21, 0x06, 0x20, 0x02, 0x2a, 0x02,
  0x04, 0x21, 0x07, 0x20, 0x02, 0x2a, 0x02, 0x08,
  0x21, 0x08, 0x20, 0x00, 0x20, 0x04, 0x20, 0x05,
  0x20, 0x07, 0x20, 0x08, 0x10, 0x0f, 0x20, 0x03,
  0x20, 0x05, 0x20, 0x06, 0x20, 0x08, 0x10, 0x0f,
  0x20, 0x03, 0x20, 0x04, 0x20, 0x06, 0x20, 0x07,
  0x10, 0x0f, 0x10, 0x08, 0x0b, 0x0d, 0x00, 0x20,
  0x00, 0x20, 0x03, 0x94, 0x20, 0x01, 0x20, 0x02,
  0x94, 0x93, 0x0b
};

// mem.wasm: memory test module with two functions:
//
// * set(i32, i32) -> i32
// * get(i32) -> i32
//
// (source: data/wat/03-mem.wat)
static const uint8_t MEM_WASM[] = {
  0x00, 0x61, 0x73, 0x6d, 0x01, 0x00, 0x00, 0x00,
  0x01, 0x0c, 0x02, 0x60, 0x01, 0x7f, 0x01, 0x7f,
  0x60, 0x02, 0x7f, 0x7f, 0x01, 0x7f, 0x03, 0x03,
  0x02, 0x00, 0x01, 0x05, 0x03, 0x01, 0x00, 0x01,
  0x07, 0x13, 0x03, 0x03, 0x6d, 0x65, 0x6d, 0x02,
  0x00, 0x03, 0x67, 0x65, 0x74, 0x00, 0x00, 0x03,
  0x73, 0x65, 0x74, 0x00, 0x01, 0x0a, 0x15, 0x02,
  0x07, 0x00, 0x20, 0x00, 0x28, 0x02, 0x00, 0x0b,
  0x0b, 0x00, 0x20, 0x00, 0x20, 0x01, 0x36, 0x02,
  0x00, 0x20, 0x01, 0x0b
};

// global.wasm: global test module with the following
// functions:
//
// * i32.get() -> i32
// * i32.set(i32)
// * i64.get() -> i64
// * i64.set(i64)
// * f32.get() -> f32
// * f32.set(f32)
// * f64.get() -> f64
// * f64.set(f64)
//
// (source: data/wat/04-global.wat)
static const uint8_t GLOBAL_WASM[] = {
  0x00, 0x61, 0x73, 0x6d, 0x01, 0x00, 0x00, 0x00,
  0x01, 0x21, 0x08, 0x60, 0x00, 0x01, 0x7f, 0x60,
  0x01, 0x7f, 0x00, 0x60, 0x00, 0x01, 0x7e, 0x60,
  0x01, 0x7e, 0x00, 0x60, 0x00, 0x01, 0x7d, 0x60,
  0x01, 0x7d, 0x00, 0x60, 0x00, 0x01, 0x7c, 0x60,
  0x01, 0x7c, 0x00, 0x03, 0x09, 0x08, 0x00, 0x01,
  0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x06, 0x1f,
  0x04, 0x7f, 0x01, 0x41, 0x00, 0x0b, 0x7e, 0x01,
  0x42, 0x00, 0x0b, 0x7d, 0x01, 0x43, 0x00, 0x00,
  0x00, 0x00, 0x0b, 0x7c, 0x01, 0x44, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0b, 0x07,
  0x69, 0x0c, 0x03, 0x69, 0x33, 0x32, 0x03, 0x00,
  0x03, 0x69, 0x36, 0x34, 0x03, 0x01, 0x03, 0x66,
  0x33, 0x32, 0x03, 0x02, 0x03, 0x66, 0x36, 0x34,
  0x03, 0x03, 0x07, 0x69, 0x33, 0x32, 0x2e, 0x67,
  0x65, 0x74, 0x00, 0x00, 0x07, 0x69, 0x33, 0x32,
  0x2e, 0x73, 0x65, 0x74, 0x00, 0x01, 0x07, 0x69,
  0x36, 0x34, 0x2e, 0x67, 0x65, 0x74, 0x00, 0x02,
  0x07, 0x69, 0x36, 0x34, 0x2e, 0x73, 0x65, 0x74,
  0x00, 0x03, 0x07, 0x66, 0x33, 0x32, 0x2e, 0x67,
  0x65, 0x74, 0x00, 0x04, 0x07, 0x66, 0x33, 0x32,
  0x2e, 0x73, 0x65, 0x74, 0x00, 0x05, 0x07, 0x66,
  0x36, 0x34, 0x2e, 0x67, 0x65, 0x74, 0x00, 0x06,
  0x07, 0x66, 0x36, 0x34, 0x2e, 0x73, 0x65, 0x74,
  0x00, 0x07, 0x0a, 0x31, 0x08, 0x04, 0x00, 0x23,
  0x00, 0x0b, 0x06, 0x00, 0x20, 0x00, 0x24, 0x00,
  0x0b, 0x04, 0x00, 0x23, 0x01, 0x0b, 0x06, 0x00,
  0x20, 0x00, 0x24, 0x01, 0x0b, 0x04, 0x00, 0x23,
  0x02, 0x0b, 0x06, 0x00, 0x20, 0x00, 0x24, 0x02,
  0x0b, 0x04, 0x00, 0x23, 0x03, 0x0b, 0x06, 0x00,
  0x20, 0x00, 0x24, 0x03, 0x0b
};

// br_table.wasm: br_table test module with the following
// function:
//
// * add_nth(i32, i32) -> i32
//
// (source: data/wat/07-br_table.wat)
static const uint8_t BR_TABLE_WASM[] = {
  0x00, 0x61, 0x73, 0x6d, 0x01, 0x00, 0x00, 0x00,
  0x01, 0x07, 0x01, 0x60, 0x02, 0x7f, 0x7f, 0x01,
  0x7f, 0x03, 0x02, 0x01, 0x00, 0x07, 0x0b, 0x01,
  0x07, 0x61, 0x64, 0x64, 0x5f, 0x6e, 0x74, 0x68,
  0x00, 0x00, 0x0a, 0x3b, 0x01, 0x39, 0x00, 0x20,
  0x00, 0x02, 0x7f, 0x41, 0x01, 0x02, 0x7f, 0x41,
  0x02, 0x02, 0x7f, 0x41, 0x03, 0x02, 0x7f, 0x41,
  0x04, 0x02, 0x7f, 0x41, 0x05, 0x02, 0x7f, 0x41,
  0x06, 0x02, 0x7f, 0x41, 0x00, 0x20, 0x01, 0x0e,
  0x06, 0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06,
  0x0b, 0x6a, 0x0b, 0x6a, 0x0b, 0x6a, 0x0b, 0x6a,
  0x0b, 0x6a, 0x0b, 0x6a, 0x0b, 0x6a, 0x0b
};

// call_indirect.wasm: call_indirect test module with the following
// function:
//
// * map(i32, i32) -> i32
//
// (source: data/wat/08-call_indirect.wat)
static const uint8_t CALL_INDIRECT_WASM[] = {
  0x00, 0x61, 0x73, 0x6d, 0x01, 0x00, 0x00, 0x00,
  0x01, 0x17, 0x04, 0x60, 0x01, 0x7f, 0x01, 0x7f,
  0x60, 0x01, 0x7d, 0x01, 0x7d, 0x60, 0x02, 0x7f,
  0x7f, 0x01, 0x7f, 0x60, 0x02, 0x7d, 0x7f, 0x01,
  0x7d, 0x03, 0x0b, 0x0a, 0x00, 0x00, 0x00, 0x00,
  0x01, 0x01, 0x01, 0x01, 0x02, 0x03, 0x04, 0x05,
  0x01, 0x70, 0x01, 0x08, 0x08, 0x07, 0x15, 0x02,
  0x07, 0x69, 0x33, 0x32, 0x5f, 0x6d, 0x61, 0x70,
  0x00, 0x08, 0x07, 0x66, 0x33, 0x32, 0x5f, 0x6d,
  0x61, 0x70, 0x00, 0x09, 0x09, 0x0e, 0x01, 0x00,
  0x41, 0x00, 0x0b, 0x08, 0x00, 0x01, 0x02, 0x03,
  0x04, 0x05, 0x06, 0x07, 0x0a, 0x61, 0x0a, 0x07,
  0x00, 0x41, 0x02, 0x20, 0x00, 0x6c, 0x0b, 0x07,
  0x00, 0x41, 0x03, 0x20, 0x00, 0x6c, 0x0b, 0x07,
  0x00, 0x20, 0x00, 0x20, 0x00, 0x6c, 0x0b, 0x0a,
  0x00, 0x20, 0x00, 0x20, 0x00, 0x20, 0x00, 0x6c,
  0x6c, 0x0b, 0x0a, 0x00, 0x43, 0x00, 0x00, 0x00,
  0x40, 0x20, 0x00, 0x94, 0x0b, 0x0a, 0x00, 0x43,
  0x00, 0x00, 0x40, 0x40, 0x20, 0x00, 0x94, 0x0b,
  0x07, 0x00, 0x20, 0x00, 0x20, 0x00, 0x94, 0x0b,
  0x0a, 0x00, 0x20, 0x00, 0x20, 0x00, 0x20, 0x00,
  0x94, 0x94, 0x0b, 0x09, 0x00, 0x20, 0x00, 0x20,
  0x01, 0x11, 0x00, 0x00, 0x0b, 0x09, 0x00, 0x20,
  0x00, 0x20, 0x01, 0x11, 0x01, 0x00, 0x0b
};

// v128-const.wasm: one function used to test a couple of simd
// functions:
//
// * i8x16_add(i32) -> i32
//
// (source: data/wat/12-v128-const.wat)
static const uint8_t V128_CONST_WASM[] = {
  0x00, 0x61, 0x73, 0x6d, 0x01, 0x00, 0x00, 0x00,
  0x01, 0x06, 0x01, 0x60, 0x01, 0x7f, 0x01, 0x7f,
  0x03, 0x02, 0x01, 0x00, 0x07, 0x0d, 0x01, 0x09,
  0x69, 0x38, 0x78, 0x31, 0x36, 0x5f, 0x61, 0x64,
  0x64, 0x00, 0x00, 0x0a, 0x32, 0x01, 0x30, 0x00,
  0xfd, 0x0c, 0x00, 0x01, 0x02, 0x03, 0x04, 0x05,
  0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d,
  0x0e, 0x0f, 0x20, 0x00, 0xfd, 0x17, 0x03, 0xfd,
  0x0c, 0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06,
  0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e,
  0x0f, 0xfd, 0x6e, 0xfd, 0x16, 0x03, 0x0b
};

// start.wasm: one function used to test module start
// functions:
//
// * get() -> i32
//
// (source: data/wat/10-start.wat)
static const uint8_t START_WASM[] = {
  0x00, 0x61, 0x73, 0x6d, 0x01, 0x00, 0x00, 0x00,
  0x01, 0x08, 0x02, 0x60, 0x00, 0x00, 0x60, 0x00,
  0x01, 0x7f, 0x03, 0x03, 0x02, 0x00, 0x01, 0x06,
  0x06, 0x01, 0x7f, 0x01, 0x41, 0x00, 0x0b, 0x07,
  0x07, 0x01, 0x03, 0x67, 0x65, 0x74, 0x00, 0x01,
  0x08, 0x01, 0x00, 0x0a, 0x10, 0x02, 0x09, 0x00,
  0x23, 0x00, 0x41, 0x2a, 0x6a, 0x24, 0x00, 0x0b,
  0x04, 0x00, 0x23, 0x00, 0x0b
};

// ops.wasm: one function to test each opcode
//
// (source: data/wat/13-ops.wat)
static const uint8_t OPS_WASM[] = {
  0x00, 0x61, 0x73, 0x6d, 0x01, 0x00, 0x00, 0x00,
  0x01, 0x92, 0x01, 0x1c, 0x60, 0x00, 0x01, 0x7f,
  0x60, 0x01, 0x7f, 0x01, 0x7f, 0x60, 0x02, 0x7f,
  0x7f, 0x01, 0x7f, 0x60, 0x03, 0x7f, 0x7f, 0x7f,
  0x01, 0x7f, 0x60, 0x00, 0x01, 0x7e, 0x60, 0x00,
  0x01, 0x7d, 0x60, 0x00, 0x01, 0x7c, 0x60, 0x01,
  0x7e, 0x01, 0x7e, 0x60, 0x01, 0x7d, 0x01, 0x7d,
  0x60, 0x01, 0x7c, 0x01, 0x7c, 0x60, 0x01, 0x7e,
  0x01, 0x7f, 0x60, 0x02, 0x7e, 0x7e, 0x01, 0x7f,
  0x60, 0x02, 0x7d, 0x7d, 0x01, 0x7f, 0x60, 0x02,
  0x7c, 0x7c, 0x01, 0x7f, 0x60, 0x02, 0x7e, 0x7e,
  0x01, 0x7e, 0x60, 0x02, 0x7d, 0x7d, 0x01, 0x7d,
  0x60, 0x02, 0x7c, 0x7c, 0x01, 0x7c, 0x60, 0x01,
  0x7d, 0x01, 0x7f, 0x60, 0x01, 0x7c, 0x01, 0x7f,
  0x60, 0x01, 0x7f, 0x01, 0x7e, 0x60, 0x01, 0x7d,
  0x01, 0x7e, 0x60, 0x01, 0x7c, 0x01, 0x7e, 0x60,
  0x01, 0x7f, 0x01, 0x7d, 0x60, 0x01, 0x7e, 0x01,
  0x7d, 0x60, 0x01, 0x7c, 0x01, 0x7d, 0x60, 0x01,
  0x7f, 0x01, 0x7c, 0x60, 0x01, 0x7e, 0x01, 0x7c,
  0x60, 0x01, 0x7d, 0x01, 0x7c, 0x03, 0xb2, 0x01,
  0xb0, 0x01, 0x00, 0x00, 0x00, 0x01, 0x00, 0x02,
  0x02, 0x02, 0x02, 0x03, 0x00, 0x01, 0x02, 0x01,
  0x01, 0x00, 0x00, 0x00, 0x04, 0x05, 0x06, 0x01,
  0x01, 0x01, 0x01, 0x07, 0x07, 0x07, 0x07, 0x07,
  0x07, 0x01, 0x07, 0x08, 0x09, 0x01, 0x01, 0x07,
  0x07, 0x07, 0x00, 0x00, 0x01, 0x02, 0x02, 0x02,
  0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x0a,
  0x0b, 0x0b, 0x0b, 0x0b, 0x0b, 0x0b, 0x0b, 0x0b,
  0x0b, 0x0b, 0x0c, 0x0c, 0x0c, 0x0c, 0x0c, 0x0c,
  0x0d, 0x0d, 0x0d, 0x0d, 0x0d, 0x0d, 0x01, 0x01,
  0x01, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02,
  0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x07,
  0x07, 0x07, 0x0e, 0x0e, 0x0e, 0x0e, 0x0e, 0x0e,
  0x0e, 0x0e, 0x0e, 0x0e, 0x0e, 0x0e, 0x0e, 0x0e,
  0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x0f,
  0x0f, 0x0f, 0x0f, 0x0f, 0x0f, 0x0f, 0x09, 0x09,
  0x09, 0x09, 0x09, 0x09, 0x09, 0x10, 0x10, 0x10,
  0x10, 0x10, 0x10, 0x10, 0x0a, 0x11, 0x11, 0x12,
  0x12, 0x13, 0x13, 0x14, 0x14, 0x15, 0x15, 0x16,
  0x16, 0x17, 0x17, 0x18, 0x19, 0x19, 0x1a, 0x1a,
  0x1b, 0x11, 0x15, 0x16, 0x1a, 0x01, 0x01, 0x07,
  0x07, 0x07, 0x11, 0x11, 0x12, 0x12, 0x14, 0x14,
  0x15, 0x15, 0x04, 0x05, 0x01, 0x70, 0x01, 0x04,
  0x04, 0x05, 0x03, 0x01, 0x00, 0x01, 0x06, 0x0d,
  0x02, 0x7f, 0x01, 0x41, 0xaf, 0x96, 0x13, 0x0b,
  0x7f, 0x01, 0x41, 0x1b, 0x0b, 0x07, 0xc7, 0x18,
  0xad, 0x01, 0x08, 0x74, 0x65, 0x73, 0x74, 0x5f,
  0x6e, 0x6f, 0x70, 0x00, 0x00, 0x0a, 0x74, 0x65,
  0x73, 0x74, 0x5f, 0x62, 0x6c, 0x6f, 0x63, 0x6b,
  0x00, 0x01, 0x09, 0x74, 0x65, 0x73, 0x74, 0x5f,
  0x6c, 0x6f, 0x6f, 0x70, 0x00, 0x02, 0x0c, 0x74,
  0x65, 0x73, 0x74, 0x5f, 0x69, 0x66, 0x5f, 0x65,
  0x6c, 0x73, 0x65, 0x00, 0x03, 0x09, 0x74, 0x65,
  0x73, 0x74, 0x5f, 0x63, 0x61, 0x6c, 0x6c, 0x00,
  0x04, 0x12, 0x74, 0x65, 0x73, 0x74, 0x5f, 0x63,
  0x61, 0x6c, 0x6c, 0x5f, 0x69, 0x6e, 0x64, 0x69,
  0x72, 0x65, 0x63, 0x74, 0x00, 0x09, 0x09, 0x74,
  0x65, 0x73, 0x74, 0x5f, 0x64, 0x72, 0x6f, 0x70,
  0x00, 0x0a, 0x0b, 0x74, 0x65, 0x73, 0x74, 0x5f,
  0x73, 0x65, 0x6c, 0x65, 0x63, 0x74, 0x00, 0x0b,
  0x0e, 0x74, 0x65, 0x73, 0x74, 0x5f, 0x6c, 0x6f,
  0x63, 0x61, 0x6c, 0x5f, 0x67, 0x65, 0x74, 0x00,
  0x0c, 0x0e, 0x74, 0x65, 0x73, 0x74, 0x5f, 0x6c,
  0x6f, 0x63, 0x61, 0x6c, 0x5f, 0x73, 0x65, 0x74,
  0x00, 0x0d, 0x0e, 0x74, 0x65, 0x73, 0x74, 0x5f,
  0x6c, 0x6f, 0x63, 0x61, 0x6c, 0x5f, 0x74, 0x65,
  0x65, 0x00, 0x0e, 0x0f, 0x74, 0x65, 0x73, 0x74,
  0x5f, 0x67, 0x6c, 0x6f, 0x62, 0x61, 0x6c, 0x5f,
  0x67, 0x65, 0x74, 0x00, 0x0f, 0x0f, 0x74, 0x65,
  0x73, 0x74, 0x5f, 0x67, 0x6c, 0x6f, 0x62, 0x61,
  0x6c, 0x5f, 0x73, 0x65, 0x74, 0x00, 0x10, 0x03,
  0x6d, 0x65, 0x6d, 0x02, 0x00, 0x0d, 0x74, 0x65,
  0x73, 0x74, 0x5f, 0x69, 0x33, 0x32, 0x5f, 0x6c,
  0x6f, 0x61, 0x64, 0x00, 0x11, 0x0d, 0x74, 0x65,
  0x73, 0x74, 0x5f, 0x69, 0x36, 0x34, 0x5f, 0x6c,
  0x6f, 0x61, 0x64, 0x00, 0x12, 0x0d, 0x74, 0x65,
  0x73, 0x74, 0x5f, 0x66, 0x33, 0x32, 0x5f, 0x6c,
  0x6f, 0x61, 0x64, 0x00, 0x13, 0x0d, 0x74, 0x65,
  0x73, 0x74, 0x5f, 0x66, 0x36, 0x34, 0x5f, 0x6c,
  0x6f, 0x61, 0x64, 0x00, 0x14, 0x10, 0x74, 0x65,
  0x73, 0x74, 0x5f, 0x69, 0x33, 0x32, 0x5f, 0x6c,
  0x6f, 0x61, 0x64, 0x38, 0x5f, 0x73, 0x00, 0x15,
  0x10, 0x74, 0x65, 0x73, 0x74, 0x5f, 0x69, 0x33,
  0x32, 0x5f, 0x6c, 0x6f, 0x61, 0x64, 0x38, 0x5f,
  0x75, 0x00, 0x16, 0x11, 0x74, 0x65, 0x73, 0x74,
  0x5f, 0x69, 0x33, 0x32, 0x5f, 0x6c, 0x6f, 0x61,
  0x64, 0x31, 0x36, 0x5f, 0x73, 0x00, 0x17, 0x11,
  0x74, 0x65, 0x73, 0x74, 0x5f, 0x69, 0x33, 0x32,
  0x5f, 0x6c, 0x6f, 0x61, 0x64, 0x31, 0x36, 0x5f,
  0x75, 0x00, 0x18, 0x10, 0x74, 0x65, 0x73, 0x74,
  0x5f, 0x69, 0x36, 0x34, 0x5f, 0x6c, 0x6f, 0x61,
  0x64, 0x38, 0x5f, 0x73, 0x00, 0x19, 0x10, 0x74,
  0x65, 0x73, 0x74, 0x5f, 0x69, 0x36, 0x34, 0x5f,
  0x6c, 0x6f, 0x61, 0x64, 0x38, 0x5f, 0x75, 0x00,
  0x1a, 0x11, 0x74, 0x65, 0x73, 0x74, 0x5f, 0x69,
  0x36, 0x34, 0x5f, 0x6c, 0x6f, 0x61, 0x64, 0x31,
  0x36, 0x5f, 0x73, 0x00, 0x1b, 0x11, 0x74, 0x65,
  0x73, 0x74, 0x5f, 0x69, 0x36, 0x34, 0x5f, 0x6c,
  0x6f, 0x61, 0x64, 0x31, 0x36, 0x5f, 0x75, 0x00,
  0x1c, 0x11, 0x74, 0x65, 0x73, 0x74, 0x5f, 0x69,
  0x36, 0x34, 0x5f, 0x6c, 0x6f, 0x61, 0x64, 0x33,
  0x32, 0x5f, 0x73, 0x00, 0x1d, 0x11, 0x74, 0x65,
  0x73, 0x74, 0x5f, 0x69, 0x36, 0x34, 0x5f, 0x6c,
  0x6f, 0x61, 0x64, 0x33, 0x32, 0x5f, 0x75, 0x00,
  0x1e, 0x0e, 0x74, 0x65, 0x73, 0x74, 0x5f, 0x69,
  0x33, 0x32, 0x5f, 0x73, 0x74, 0x6f, 0x72, 0x65,
  0x00, 0x1f, 0x0e, 0x74, 0x65, 0x73, 0x74, 0x5f,
  0x69, 0x36, 0x34, 0x5f, 0x73, 0x74, 0x6f, 0x72,
  0x65, 0x00, 0x20, 0x0e, 0x74, 0x65, 0x73, 0x74,
  0x5f, 0x66, 0x33, 0x32, 0x5f, 0x73, 0x74, 0x6f,
  0x72, 0x65, 0x00, 0x21, 0x0e, 0x74, 0x65, 0x73,
  0x74, 0x5f, 0x66, 0x36, 0x34, 0x5f, 0x73, 0x74,
  0x6f, 0x72, 0x65, 0x00, 0x22, 0x0f, 0x74, 0x65,
  0x73, 0x74, 0x5f, 0x69, 0x33, 0x32, 0x5f, 0x73,
  0x74, 0x6f, 0x72, 0x65, 0x38, 0x00, 0x23, 0x10,
  0x74, 0x65, 0x73, 0x74, 0x5f, 0x69, 0x33, 0x32,
  0x5f, 0x73, 0x74, 0x6f, 0x72, 0x65, 0x31, 0x36,
  0x00, 0x24, 0x0f, 0x74, 0x65, 0x73, 0x74, 0x5f,
  0x69, 0x36, 0x34, 0x5f, 0x73, 0x74, 0x6f, 0x72,
  0x65, 0x38, 0x00, 0x25, 0x10, 0x74, 0x65, 0x73,
  0x74, 0x5f, 0x69, 0x36, 0x34, 0x5f, 0x73, 0x74,
  0x6f, 0x72, 0x65, 0x31, 0x36, 0x00, 0x26, 0x10,
  0x74, 0x65, 0x73, 0x74, 0x5f, 0x69, 0x36, 0x34,
  0x5f, 0x73, 0x74, 0x6f, 0x72, 0x65, 0x33, 0x32,
  0x00, 0x27, 0x10, 0x74, 0x65, 0x73, 0x74, 0x5f,
  0x6d, 0x65, 0x6d, 0x6f, 0x72, 0x79, 0x5f, 0x73,
  0x69, 0x7a, 0x65, 0x00, 0x28, 0x10, 0x74, 0x65,
  0x73, 0x74, 0x5f, 0x6d, 0x65, 0x6d, 0x6f, 0x72,
  0x79, 0x5f, 0x67, 0x72, 0x6f, 0x77, 0x00, 0x29,
  0x0c, 0x74, 0x65, 0x73, 0x74, 0x5f, 0x69, 0x33,
  0x32, 0x5f, 0x65, 0x71, 0x7a, 0x00, 0x2a, 0x0b,
  0x74, 0x65, 0x73, 0x74, 0x5f, 0x69, 0x33, 0x32,
  0x5f, 0x65, 0x71, 0x00, 0x2b, 0x0b, 0x74, 0x65,
  0x73, 0x74, 0x5f, 0x69, 0x33, 0x32, 0x5f, 0x6e,
  0x65, 0x00, 0x2c, 0x0d, 0x74, 0x65, 0x73, 0x74,
  0x5f, 0x69, 0x33, 0x32, 0x5f, 0x6c, 0x74, 0x5f,
  0x73, 0x00, 0x2d, 0x0d, 0x74, 0x65, 0x73, 0x74,
  0x5f, 0x69, 0x33, 0x32, 0x5f, 0x6c, 0x74, 0x5f,
  0x75, 0x00, 0x2e, 0x0d, 0x74, 0x65, 0x73, 0x74,
  0x5f, 0x69, 0x33, 0x32, 0x5f, 0x67, 0x74, 0x5f,
  0x73, 0x00, 0x2f, 0x0d, 0x74, 0x65, 0x73, 0x74,
  0x5f, 0x69, 0x33, 0x32, 0x5f, 0x67, 0x74, 0x5f,
  0x75, 0x00, 0x30, 0x0d, 0x74, 0x65, 0x73, 0x74,
  0x5f, 0x69, 0x33, 0x32, 0x5f, 0x6c, 0x65, 0x5f,
  0x73, 0x00, 0x31, 0x0d, 0x74, 0x65, 0x73, 0x74,
  0x5f, 0x69, 0x33, 0x32, 0x5f, 0x6c, 0x65, 0x5f,
  0x75, 0x00, 0x32, 0x0d, 0x74, 0x65, 0x73, 0x74,
  0x5f, 0x69, 0x33, 0x32, 0x5f, 0x67, 0x65, 0x5f,
  0x73, 0x00, 0x33, 0x0d, 0x74, 0x65, 0x73, 0x74,
  0x5f, 0x69, 0x33, 0x32, 0x5f, 0x67, 0x65, 0x5f,
  0x75, 0x00, 0x34, 0x0c, 0x74, 0x65, 0x73, 0x74,
  0x5f, 0x69, 0x36, 0x34, 0x5f, 0x65, 0x71, 0x7a,
  0x00, 0x35, 0x0b, 0x74, 0x65, 0x73, 0x74, 0x5f,
  0x69, 0x36, 0x34, 0x5f, 0x65, 0x71, 0x00, 0x36,
  0x0b, 0x74, 0x65, 0x73, 0x74, 0x5f, 0x69, 0x36,
  0x34, 0x5f, 0x6e, 0x65, 0x00, 0x37, 0x0d, 0x74,
  0x65, 0x73, 0x74, 0x5f, 0x69, 0x36, 0x34, 0x5f,
  0x6c, 0x74, 0x5f, 0x73, 0x00, 0x38, 0x0d, 0x74,
  0x65, 0x73, 0x74, 0x5f, 0x69, 0x36, 0x34, 0x5f,
  0x6c, 0x74, 0x5f, 0x75, 0x00, 0x39, 0x0d, 0x74,
  0x65, 0x73, 0x74, 0x5f, 0x69, 0x36, 0x34, 0x5f,
  0x67, 0x74, 0x5f, 0x73, 0x00, 0x3a, 0x0d, 0x74,
  0x65, 0x73, 0x74, 0x5f, 0x69, 0x36, 0x34, 0x5f,
  0x67, 0x74, 0x5f, 0x75, 0x00, 0x3b, 0x0d, 0x74,
  0x65, 0x73, 0x74, 0x5f, 0x69, 0x36, 0x34, 0x5f,
  0x6c, 0x65, 0x5f, 0x73, 0x00, 0x3c, 0x0d, 0x74,
  0x65, 0x73, 0x74, 0x5f, 0x69, 0x36, 0x34, 0x5f,
  0x6c, 0x65, 0x5f, 0x75, 0x00, 0x3d, 0x0d, 0x74,
  0x65, 0x73, 0x74, 0x5f, 0x69, 0x36, 0x34, 0x5f,
  0x67, 0x65, 0x5f, 0x73, 0x00, 0x3e, 0x0d, 0x74,
  0x65, 0x73, 0x74, 0x5f, 0x69, 0x36, 0x34, 0x5f,
  0x67, 0x65, 0x5f, 0x75, 0x00, 0x3f, 0x0b, 0x74,
  0x65, 0x73, 0x74, 0x5f, 0x66, 0x33, 0x32, 0x5f,
  0x65, 0x71, 0x00, 0x40, 0x0b, 0x74, 0x65, 0x73,
  0x74, 0x5f, 0x66, 0x33, 0x32, 0x5f, 0x6e, 0x65,
  0x00, 0x41, 0x0b, 0x74, 0x65, 0x73, 0x74, 0x5f,
  0x66, 0x33, 0x32, 0x5f, 0x6c, 0x74, 0x00, 0x42,
  0x0b, 0x74, 0x65, 0x73, 0x74, 0x5f, 0x66, 0x33,
  0x32, 0x5f, 0x67, 0x74, 0x00, 0x43, 0x0b, 0x74,
  0x65, 0x73, 0x74, 0x5f, 0x66, 0x33, 0x32, 0x5f,
  0x6c, 0x65, 0x00, 0x44, 0x0b, 0x74, 0x65, 0x73,
  0x74, 0x5f, 0x66, 0x33, 0x32, 0x5f, 0x67, 0x65,
  0x00, 0x45, 0x0b, 0x74, 0x65, 0x73, 0x74, 0x5f,
  0x66, 0x36, 0x34, 0x5f, 0x65, 0x71, 0x00, 0x46,
  0x0b, 0x74, 0x65, 0x73, 0x74, 0x5f, 0x66, 0x36,
  0x34, 0x5f, 0x6e, 0x65, 0x00, 0x47, 0x0b, 0x74,
  0x65, 0x73, 0x74, 0x5f, 0x66, 0x36, 0x34, 0x5f,
  0x6c, 0x74, 0x00, 0x48, 0x0b, 0x74, 0x65, 0x73,
  0x74, 0x5f, 0x66, 0x36, 0x34, 0x5f, 0x67, 0x74,
  0x00, 0x49, 0x0b, 0x74, 0x65, 0x73, 0x74, 0x5f,
  0x66, 0x36, 0x34, 0x5f, 0x6c, 0x65, 0x00, 0x4a,
  0x0b, 0x74, 0x65, 0x73, 0x74, 0x5f, 0x66, 0x36,
  0x34, 0x5f, 0x67, 0x65, 0x00, 0x4b, 0x0c, 0x74,
  0x65, 0x73, 0x74, 0x5f, 0x69, 0x33, 0x32, 0x5f,
  0x63, 0x6c, 0x7a, 0x00, 0x4c, 0x0c, 0x74, 0x65,
  0x73, 0x74, 0x5f, 0x69, 0x33, 0x32, 0x5f, 0x63,
  0x74, 0x7a, 0x00, 0x4d, 0x0f, 0x74, 0x65, 0x73,
  0x74, 0x5f, 0x69, 0x33, 0x32, 0x5f, 0x70, 0x6f,
  0x70, 0x63, 0x6e, 0x74, 0x00, 0x4e, 0x0c, 0x74,
  0x65, 0x73, 0x74, 0x5f, 0x69, 0x33, 0x32, 0x5f,
  0x61, 0x64, 0x64, 0x00, 0x4f, 0x0c, 0x74, 0x65,
  0x73, 0x74, 0x5f, 0x69, 0x33, 0x32, 0x5f, 0x73,
  0x75, 0x62, 0x00, 0x50, 0x0e, 0x74, 0x65, 0x73,
  0x74, 0x5f, 0x69, 0x33, 0x32, 0x5f, 0x64, 0x69,
  0x76, 0x5f, 0x73, 0x00, 0x51, 0x0e, 0x74, 0x65,
  0x73, 0x74, 0x5f, 0x69, 0x33, 0x32, 0x5f, 0x64,
  0x69, 0x76, 0x5f, 0x75, 0x00, 0x52, 0x0e, 0x74,
  0x65, 0x73, 0x74, 0x5f, 0x69, 0x33, 0x32, 0x5f,
  0x72, 0x65, 0x6d, 0x5f, 0x73, 0x00, 0x53, 0x0e,
  0x74, 0x65, 0x73, 0x74, 0x5f, 0x69, 0x33, 0x32,
  0x5f, 0x72, 0x65, 0x6d, 0x5f, 0x75, 0x00, 0x54,
  0x0c, 0x74, 0x65, 0x73, 0x74, 0x5f, 0x69, 0x33,
  0x32, 0x5f, 0x61, 0x6e, 0x64, 0x00, 0x55, 0x0b,
  0x74, 0x65, 0x73, 0x74, 0x5f, 0x69, 0x33, 0x32,
  0x5f, 0x6f, 0x72, 0x00, 0x56, 0x0c, 0x74, 0x65,
  0x73, 0x74, 0x5f, 0x69, 0x33, 0x32, 0x5f, 0x78,
  0x6f, 0x72, 0x00, 0x57, 0x0c, 0x74, 0x65, 0x73,
  0x74, 0x5f, 0x69, 0x33, 0x32, 0x5f, 0x73, 0x68,
  0x6c, 0x00, 0x58, 0x0e, 0x74, 0x65, 0x73, 0x74,
  0x5f, 0x69, 0x33, 0x32, 0x5f, 0x73, 0x68, 0x72,
  0x5f, 0x73, 0x00, 0x59, 0x0e, 0x74, 0x65, 0x73,
  0x74, 0x5f, 0x69, 0x33, 0x32, 0x5f, 0x73, 0x68,
  0x72, 0x5f, 0x75, 0x00, 0x5a, 0x0d, 0x74, 0x65,
  0x73, 0x74, 0x5f, 0x69, 0x33, 0x32, 0x5f, 0x72,
  0x6f, 0x74, 0x6c, 0x00, 0x5b, 0x0d, 0x74, 0x65,
  0x73, 0x74, 0x5f, 0x69, 0x33, 0x32, 0x5f, 0x72,
  0x6f, 0x74, 0x72, 0x00, 0x5c, 0x0c, 0x74, 0x65,
  0x73, 0x74, 0x5f, 0x69, 0x36, 0x34, 0x5f, 0x63,
  0x6c, 0x7a, 0x00, 0x5d, 0x0c, 0x74, 0x65, 0x73,
  0x74, 0x5f, 0x69, 0x36, 0x34, 0x5f, 0x63, 0x74,
  0x7a, 0x00, 0x5e, 0x0f, 0x74, 0x65, 0x73, 0x74,
  0x5f, 0x69, 0x36, 0x34, 0x5f, 0x70, 0x6f, 0x70,
  0x63, 0x6e, 0x74, 0x00, 0x5f, 0x0c, 0x74, 0x65,
  0x73, 0x74, 0x5f, 0x69, 0x36, 0x34, 0x5f, 0x61,
  0x64, 0x64, 0x00, 0x60, 0x0c, 0x74, 0x65, 0x73,
  0x74, 0x5f, 0x69, 0x36, 0x34, 0x5f, 0x73, 0x75,
  0x62, 0x00, 0x61, 0x0e, 0x74, 0x65, 0x73, 0x74,
  0x5f, 0x69, 0x36, 0x34, 0x5f, 0x64, 0x69, 0x76,
  0x5f, 0x73, 0x00, 0x62, 0x0e, 0x74, 0x65, 0x73,
  0x74, 0x5f, 0x69, 0x36, 0x34, 0x5f, 0x64, 0x69,
  0x76, 0x5f, 0x75, 0x00, 0x63, 0x0e, 0x74, 0x65,
  0x73, 0x74, 0x5f, 0x69, 0x36, 0x34, 0x5f, 0x72,
  0x65, 0x6d, 0x5f, 0x73, 0x00, 0x64, 0x0e, 0x74,
  0x65, 0x73, 0x74, 0x5f, 0x69, 0x36, 0x34, 0x5f,
  0x72, 0x65, 0x6d, 0x5f, 0x75, 0x00, 0x65, 0x0c,
  0x74, 0x65, 0x73, 0x74, 0x5f, 0x69, 0x36, 0x34,
  0x5f, 0x61, 0x6e, 0x64, 0x00, 0x66, 0x0b, 0x74,
  0x65, 0x73, 0x74, 0x5f, 0x69, 0x36, 0x34, 0x5f,
  0x6f, 0x72, 0x00, 0x67, 0x0c, 0x74, 0x65, 0x73,
  0x74, 0x5f, 0x69, 0x36, 0x34, 0x5f, 0x78, 0x6f,
  0x72, 0x00, 0x68, 0x0c, 0x74, 0x65, 0x73, 0x74,
  0x5f, 0x69, 0x36, 0x34, 0x5f, 0x73, 0x68, 0x6c,
  0x00, 0x69, 0x0e, 0x74, 0x65, 0x73, 0x74, 0x5f,
  0x69, 0x36, 0x34, 0x5f, 0x73, 0x68, 0x72, 0x5f,
  0x73, 0x00, 0x6a, 0x0e, 0x74, 0x65, 0x73, 0x74,
  0x5f, 0x69, 0x36, 0x34, 0x5f, 0x73, 0x68, 0x72,
  0x5f, 0x75, 0x00, 0x6b, 0x0d, 0x74, 0x65, 0x73,
  0x74, 0x5f, 0x69, 0x36, 0x34, 0x5f, 0x72, 0x6f,
  0x74, 0x6c, 0x00, 0x6c, 0x0d, 0x74, 0x65, 0x73,
  0x74, 0x5f, 0x69, 0x36, 0x34, 0x5f, 0x72, 0x6f,
  0x74, 0x72, 0x00, 0x6d, 0x0c, 0x74, 0x65, 0x73,
  0x74, 0x5f, 0x66, 0x33, 0x32, 0x5f, 0x61, 0x62,
  0x73, 0x00, 0x6e, 0x0c, 0x74, 0x65, 0x73, 0x74,
  0x5f, 0x66, 0x33, 0x32, 0x5f, 0x6e, 0x65, 0x67,
  0x00, 0x6f, 0x0d, 0x74, 0x65, 0x73, 0x74, 0x5f,
  0x66, 0x33, 0x32, 0x5f, 0x63, 0x65, 0x69, 0x6c,
  0x00, 0x70, 0x0e, 0x74, 0x65, 0x73, 0x74, 0x5f,
  0x66, 0x33, 0x32, 0x5f, 0x66, 0x6c, 0x6f, 0x6f,
  0x72, 0x00, 0x71, 0x0e, 0x74, 0x65, 0x73, 0x74,
  0x5f, 0x66, 0x33, 0x32, 0x5f, 0x74, 0x72, 0x75,
  0x6e, 0x63, 0x00, 0x72, 0x10, 0x74, 0x65, 0x73,
  0x74, 0x5f, 0x66, 0x33, 0x32, 0x5f, 0x6e, 0x65,
  0x61, 0x72, 0x65, 0x73, 0x74, 0x00, 0x73, 0x0d,
  0x74, 0x65, 0x73, 0x74, 0x5f, 0x66, 0x33, 0x32,
  0x5f, 0x73, 0x71, 0x72, 0x74, 0x00, 0x74, 0x0c,
  0x74, 0x65, 0x73, 0x74, 0x5f, 0x66, 0x33, 0x32,
  0x5f, 0x61, 0x64, 0x64, 0x00, 0x75, 0x0c, 0x74,
  0x65, 0x73, 0x74, 0x5f, 0x66, 0x33, 0x32, 0x5f,
  0x73, 0x75, 0x62, 0x00, 0x76, 0x0c, 0x74, 0x65,
  0x73, 0x74, 0x5f, 0x66, 0x33, 0x32, 0x5f, 0x6d,
  0x75, 0x6c, 0x00, 0x77, 0x0c, 0x74, 0x65, 0x73,
  0x74, 0x5f, 0x66, 0x33, 0x32, 0x5f, 0x64, 0x69,
  0x76, 0x00, 0x78, 0x0c, 0x74, 0x65, 0x73, 0x74,
  0x5f, 0x66, 0x33, 0x32, 0x5f, 0x6d, 0x69, 0x6e,
  0x00, 0x79, 0x0c, 0x74, 0x65, 0x73, 0x74, 0x5f,
  0x66, 0x33, 0x32, 0x5f, 0x6d, 0x61, 0x78, 0x00,
  0x7a, 0x11, 0x74, 0x65, 0x73, 0x74, 0x5f, 0x66,
  0x33, 0x32, 0x5f, 0x63, 0x6f, 0x70, 0x79, 0x73,
  0x69, 0x67, 0x6e, 0x00, 0x7b, 0x0c, 0x74, 0x65,
  0x73, 0x74, 0x5f, 0x66, 0x36, 0x34, 0x5f, 0x61,
  0x62, 0x73, 0x00, 0x7c, 0x0c, 0x74, 0x65, 0x73,
  0x74, 0x5f, 0x66, 0x36, 0x34, 0x5f, 0x6e, 0x65,
  0x67, 0x00, 0x7d, 0x0d, 0x74, 0x65, 0x73, 0x74,
  0x5f, 0x66, 0x36, 0x34, 0x5f, 0x63, 0x65, 0x69,
  0x6c, 0x00, 0x7e, 0x0e, 0x74, 0x65, 0x73, 0x74,
  0x5f, 0x66, 0x36, 0x34, 0x5f, 0x66, 0x6c, 0x6f,
  0x6f, 0x72, 0x00, 0x7f, 0x0e, 0x74, 0x65, 0x73,
  0x74, 0x5f, 0x66, 0x36, 0x34, 0x5f, 0x74, 0x72,
  0x75, 0x6e, 0x63, 0x00, 0x80, 0x01, 0x10, 0x74,
  0x65, 0x73, 0x74, 0x5f, 0x66, 0x36, 0x34, 0x5f,
  0x6e, 0x65, 0x61, 0x72, 0x65, 0x73, 0x74, 0x00,
  0x81, 0x01, 0x0d, 0x74, 0x65, 0x73, 0x74, 0x5f,
  0x66, 0x36, 0x34, 0x5f, 0x73, 0x71, 0x72, 0x74,
  0x00, 0x82, 0x01, 0x0c, 0x74, 0x65, 0x73, 0x74,
  0x5f, 0x66, 0x36, 0x34, 0x5f, 0x61, 0x64, 0x64,
  0x00, 0x83, 0x01, 0x0c, 0x74, 0x65, 0x73, 0x74,
  0x5f, 0x66, 0x36, 0x34, 0x5f, 0x73, 0x75, 0x62,
  0x00, 0x84, 0x01, 0x0c, 0x74, 0x65, 0x73, 0x74,
  0x5f, 0x66, 0x36, 0x34, 0x5f, 0x6d, 0x75, 0x6c,
  0x00, 0x85, 0x01, 0x0c, 0x74, 0x65, 0x73, 0x74,
  0x5f, 0x66, 0x36, 0x34, 0x5f, 0x64, 0x69, 0x76,
  0x00, 0x86, 0x01, 0x0c, 0x74, 0x65, 0x73, 0x74,
  0x5f, 0x66, 0x36, 0x34, 0x5f, 0x6d, 0x69, 0x6e,
  0x00, 0x87, 0x01, 0x0c, 0x74, 0x65, 0x73, 0x74,
  0x5f, 0x66, 0x36, 0x34, 0x5f, 0x6d, 0x61, 0x78,
  0x00, 0x88, 0x01, 0x11, 0x74, 0x65, 0x73, 0x74,
  0x5f, 0x66, 0x36, 0x34, 0x5f, 0x63, 0x6f, 0x70,
  0x79, 0x73, 0x69, 0x67, 0x6e, 0x00, 0x89, 0x01,
  0x11, 0x74, 0x65, 0x73, 0x74, 0x5f, 0x69, 0x33,
  0x32, 0x5f, 0x77, 0x72, 0x61, 0x70, 0x5f, 0x69,
  0x36, 0x34, 0x00, 0x8a, 0x01, 0x14, 0x74, 0x65,
  0x73, 0x74, 0x5f, 0x69, 0x33, 0x32, 0x5f, 0x74,
  0x72, 0x75, 0x6e, 0x63, 0x5f, 0x66, 0x33, 0x32,
  0x5f, 0x73, 0x00, 0x8b, 0x01, 0x14, 0x74, 0x65,
  0x73, 0x74, 0x5f, 0x69, 0x33, 0x32, 0x5f, 0x74,
  0x72, 0x75, 0x6e, 0x63, 0x5f, 0x66, 0x33, 0x32,
  0x5f, 0x75, 0x00, 0x8c, 0x01, 0x14, 0x74, 0x65,
  0x73, 0x74, 0x5f, 0x69, 0x33, 0x32, 0x5f, 0x74,
  0x72, 0x75, 0x6e, 0x63, 0x5f, 0x66, 0x36, 0x34,
  0x5f, 0x73, 0x00, 0x8d, 0x01, 0x14, 0x74, 0x65,
  0x73, 0x74, 0x5f, 0x69, 0x33, 0x32, 0x5f, 0x74,
  0x72, 0x75, 0x6e, 0x63, 0x5f, 0x66, 0x36, 0x34,
  0x5f, 0x75, 0x00, 0x8e, 0x01, 0x15, 0x74, 0x65,
  0x73, 0x74, 0x5f, 0x69, 0x36, 0x34, 0x5f, 0x65,
  0x78, 0x74, 0x65, 0x6e, 0x64, 0x5f, 0x69, 0x33,
  0x32, 0x5f, 0x73, 0x00, 0x8f, 0x01, 0x15, 0x74,
  0x65, 0x73, 0x74, 0x5f, 0x69, 0x36, 0x34, 0x5f,
  0x65, 0x78, 0x74, 0x65, 0x6e, 0x64, 0x5f, 0x69,
  0x33, 0x32, 0x5f, 0x75, 0x00, 0x90, 0x01, 0x14,
  0x74, 0x65, 0x73, 0x74, 0x5f, 0x69, 0x36, 0x34,
  0x5f, 0x74, 0x72, 0x75, 0x6e, 0x63, 0x5f, 0x66,
  0x33, 0x32, 0x5f, 0x73, 0x00, 0x91, 0x01, 0x14,
  0x74, 0x65, 0x73, 0x74, 0x5f, 0x69, 0x36, 0x34,
  0x5f, 0x74, 0x72, 0x75, 0x6e, 0x63, 0x5f, 0x66,
  0x33, 0x32, 0x5f, 0x75, 0x00, 0x92, 0x01, 0x14,
  0x74, 0x65, 0x73, 0x74, 0x5f, 0x69, 0x36, 0x34,
  0x5f, 0x74, 0x72, 0x75, 0x6e, 0x63, 0x5f, 0x66,
  0x36, 0x34, 0x5f, 0x73, 0x00, 0x93, 0x01, 0x14,
  0x74, 0x65, 0x73, 0x74, 0x5f, 0x69, 0x36, 0x34,
  0x5f, 0x74, 0x72, 0x75, 0x6e, 0x63, 0x5f, 0x66,
  0x36, 0x34, 0x5f, 0x75, 0x00, 0x94, 0x01, 0x16,
  0x74, 0x65, 0x73, 0x74, 0x5f, 0x66, 0x33, 0x32,
  0x5f, 0x63, 0x6f, 0x6e, 0x76, 0x65, 0x72, 0x74,
  0x5f, 0x69, 0x33, 0x32, 0x5f, 0x73, 0x00, 0x95,
  0x01, 0x16, 0x74, 0x65, 0x73, 0x74, 0x5f, 0x66,
  0x33, 0x32, 0x5f, 0x63, 0x6f, 0x6e, 0x76, 0x65,
  0x72, 0x74, 0x5f, 0x69, 0x33, 0x32, 0x5f, 0x75,
  0x00, 0x96, 0x01, 0x16, 0x74, 0x65, 0x73, 0x74,
  0x5f, 0x66, 0x33, 0x32, 0x5f, 0x63, 0x6f, 0x6e,
  0x76, 0x65, 0x72, 0x74, 0x5f, 0x69, 0x36, 0x34,
  0x5f, 0x73, 0x00, 0x97, 0x01, 0x16, 0x74, 0x65,
  0x73, 0x74, 0x5f, 0x66, 0x33, 0x32, 0x5f, 0x63,
  0x6f, 0x6e, 0x76, 0x65, 0x72, 0x74, 0x5f, 0x69,
  0x36, 0x34, 0x5f, 0x75, 0x00, 0x98, 0x01, 0x13,
  0x74, 0x65, 0x73, 0x74, 0x5f, 0x66, 0x33, 0x32,
  0x5f, 0x64, 0x65, 0x6d, 0x6f, 0x74, 0x65, 0x5f,
  0x66, 0x36, 0x34, 0x00, 0x99, 0x01, 0x16, 0x74,
  0x65, 0x73, 0x74, 0x5f, 0x66, 0x36, 0x34, 0x5f,
  0x63, 0x6f, 0x6e, 0x76, 0x65, 0x72, 0x74, 0x5f,
  0x69, 0x33, 0x32, 0x5f, 0x73, 0x00, 0x9a, 0x01,
  0x16, 0x74, 0x65, 0x73, 0x74, 0x5f, 0x66, 0x36,
  0x34, 0x5f, 0x63, 0x6f, 0x6e, 0x76, 0x65, 0x72,
  0x74, 0x5f, 0x69, 0x33, 0x32, 0x5f, 0x75, 0x00,
  0x9b, 0x01, 0x16, 0x74, 0x65, 0x73, 0x74, 0x5f,
  0x66, 0x36, 0x34, 0x5f, 0x63, 0x6f, 0x6e, 0x76,
  0x65, 0x72, 0x74, 0x5f, 0x69, 0x36, 0x34, 0x5f,
  0x73, 0x00, 0x9c, 0x01, 0x16, 0x74, 0x65, 0x73,
  0x74, 0x5f, 0x66, 0x36, 0x34, 0x5f, 0x63, 0x6f,
  0x6e, 0x76, 0x65, 0x72, 0x74, 0x5f, 0x69, 0x36,
  0x34, 0x5f, 0x75, 0x00, 0x9d, 0x01, 0x14, 0x74,
  0x65, 0x73, 0x74, 0x5f, 0x66, 0x36, 0x34, 0x5f,
  0x70, 0x72, 0x6f, 0x6d, 0x6f, 0x74, 0x65, 0x5f,
  0x66, 0x33, 0x32, 0x00, 0x9e, 0x01, 0x18, 0x74,
  0x65, 0x73, 0x74, 0x5f, 0x69, 0x33, 0x32, 0x5f,
  0x72, 0x65, 0x69, 0x6e, 0x74, 0x65, 0x72, 0x70,
  0x72, 0x65, 0x74, 0x5f, 0x66, 0x33, 0x32, 0x00,
  0x9f, 0x01, 0x18, 0x74, 0x65, 0x73, 0x74, 0x5f,
  0x69, 0x36, 0x34, 0x5f, 0x72, 0x65, 0x69, 0x6e,
  0x74, 0x65, 0x72, 0x70, 0x72, 0x65, 0x74, 0x5f,
  0x66, 0x36, 0x34, 0x00, 0xa0, 0x01, 0x18, 0x74,
  0x65, 0x73, 0x74, 0x5f, 0x66, 0x33, 0x32, 0x5f,
  0x72, 0x65, 0x69, 0x6e, 0x74, 0x65, 0x72, 0x70,
  0x72, 0x65, 0x74, 0x5f, 0x69, 0x33, 0x32, 0x00,
  0xa1, 0x01, 0x18, 0x74, 0x65, 0x73, 0x74, 0x5f,
  0x66, 0x36, 0x34, 0x5f, 0x72, 0x65, 0x69, 0x6e,
  0x74, 0x65, 0x72, 0x70, 0x72, 0x65, 0x74, 0x5f,
  0x69, 0x36, 0x34, 0x00, 0xa2, 0x01, 0x12, 0x74,
  0x65, 0x73, 0x74, 0x5f, 0x69, 0x33, 0x32, 0x5f,
  0x65, 0x78, 0x74, 0x65, 0x6e, 0x64, 0x38, 0x5f,
  0x73, 0x00, 0xa3, 0x01, 0x13, 0x74, 0x65, 0x73,
  0x74, 0x5f, 0x69, 0x33, 0x32, 0x5f, 0x65, 0x78,
  0x74, 0x65, 0x6e, 0x64, 0x31, 0x36, 0x5f, 0x73,
  0x00, 0xa4, 0x01, 0x12, 0x74, 0x65, 0x73, 0x74,
  0x5f, 0x69, 0x36, 0x34, 0x5f, 0x65, 0x78, 0x74,
  0x65, 0x6e, 0x64, 0x38, 0x5f, 0x73, 0x00, 0xa5,
  0x01, 0x13, 0x74, 0x65, 0x73, 0x74, 0x5f, 0x69,
  0x36, 0x34, 0x5f, 0x65, 0x78, 0x74, 0x65, 0x6e,
  0x64, 0x31, 0x36, 0x5f, 0x73, 0x00, 0xa6, 0x01,
  0x13, 0x74, 0x65, 0x73, 0x74, 0x5f, 0x69, 0x36,
  0x34, 0x5f, 0x65, 0x78, 0x74, 0x65, 0x6e, 0x64,
  0x33, 0x32, 0x5f, 0x73, 0x00, 0xa7, 0x01, 0x18,
  0x74, 0x65, 0x73, 0x74, 0x5f, 0x69, 0x33, 0x32,
  0x2e, 0x74, 0x72, 0x75, 0x6e, 0x63, 0x5f, 0x73,
  0x61, 0x74, 0x5f, 0x66, 0x33, 0x32, 0x5f, 0x73,
  0x00, 0xa8, 0x01, 0x18, 0x74, 0x65, 0x73, 0x74,
  0x5f, 0x69, 0x33, 0x32, 0x2e, 0x74, 0x72, 0x75,
  0x6e, 0x63, 0x5f, 0x73, 0x61, 0x74, 0x5f, 0x66,
  0x33, 0x32, 0x5f, 0x75, 0x00, 0xa9, 0x01, 0x18,
  0x74, 0x65, 0x73, 0x74, 0x5f, 0x69, 0x33, 0x32,
  0x2e, 0x74, 0x72, 0x75, 0x6e, 0x63, 0x5f, 0x73,
  0x61, 0x74, 0x5f, 0x66, 0x36, 0x34, 0x5f, 0x73,
  0x00, 0xaa, 0x01, 0x18, 0x74, 0x65, 0x73, 0x74,
  0x5f, 0x69, 0x33, 0x32, 0x2e, 0x74, 0x72, 0x75,
  0x6e, 0x63, 0x5f, 0x73, 0x61, 0x74, 0x5f, 0x66,
  0x36, 0x34, 0x5f, 0x75, 0x00, 0xab, 0x01, 0x18,
  0x74, 0x65, 0x73, 0x74, 0x5f, 0x69, 0x36, 0x34,
  0x2e, 0x74, 0x72, 0x75, 0x6e, 0x63, 0x5f, 0x73,
  0x61, 0x74, 0x5f, 0x66, 0x33, 0x32, 0x5f, 0x73,
  0x00, 0xac, 0x01, 0x18, 0x74, 0x65, 0x73, 0x74,
  0x5f, 0x69, 0x36, 0x34, 0x2e, 0x74, 0x72, 0x75,
  0x6e, 0x63, 0x5f, 0x73, 0x61, 0x74, 0x5f, 0x66,
  0x33, 0x32, 0x5f, 0x75, 0x00, 0xad, 0x01, 0x18,
  0x74, 0x65, 0x73, 0x74, 0x5f, 0x69, 0x36, 0x34,
  0x2e, 0x74, 0x72, 0x75, 0x6e, 0x63, 0x5f, 0x73,
  0x61, 0x74, 0x5f, 0x66, 0x36, 0x34, 0x5f, 0x73,
  0x00, 0xae, 0x01, 0x18, 0x74, 0x65, 0x73, 0x74,
  0x5f, 0x69, 0x36, 0x34, 0x2e, 0x74, 0x72, 0x75,
  0x6e, 0x63, 0x5f, 0x73, 0x61, 0x74, 0x5f, 0x66,
  0x36, 0x34, 0x5f, 0x75, 0x00, 0xaf, 0x01, 0x09,
  0x0a, 0x01, 0x00, 0x41, 0x00, 0x0b, 0x04, 0x05,
  0x06, 0x07, 0x08, 0x0a, 0xb3, 0x0c, 0xb0, 0x01,
  0x06, 0x00, 0x01, 0x41, 0xd2, 0x09, 0x0b, 0x11,
  0x01, 0x01, 0x7f, 0x41, 0x0c, 0x21, 0x00, 0x02,
  0x40, 0x41, 0x22, 0x21, 0x00, 0x0b, 0x20, 0x00,
  0x0b, 0x21, 0x01, 0x02, 0x7f, 0x41, 0x05, 0x21,
  0x00, 0x41, 0x00, 0x21, 0x01, 0x03, 0x40, 0x20,
  0x01, 0x41, 0x01, 0x6a, 0x21, 0x01, 0x20, 0x00,
  0x41, 0x01, 0x6b, 0x22, 0x00, 0x0d, 0x00, 0x0b,
  0x20, 0x01, 0x0b, 0x0f, 0x00, 0x20, 0x00, 0x41,
  0x02, 0x70, 0x04, 0x7f, 0x41, 0x21, 0x05, 0x41,
  0x16, 0x0b, 0x0b, 0x0b, 0x00, 0x41, 0x00, 0x10,
  0x03, 0x41, 0x01, 0x10, 0x03, 0x6a, 0x0b, 0x07,
  0x00, 0x20, 0x00, 0x20, 0x01, 0x6a, 0x0b, 0x07,
  0x00, 0x20, 0x00, 0x20, 0x01, 0x6b, 0x0b, 0x07,
  0x00, 0x20, 0x00, 0x20, 0x01, 0x6c, 0x0b, 0x04,
  0x00, 0x20, 0x00, 0x0b, 0x0b, 0x00, 0x20, 0x01,
  0x20, 0x02, 0x20, 0x00, 0x11, 0x02, 0x00, 0x0b,
  0x07, 0x00, 0x41, 0x02, 0x41, 0x01, 0x1a, 0x0b,
  0x0c, 0x00, 0x41, 0x01, 0x41, 0x00, 0x20, 0x00,
  0x41, 0x02, 0x70, 0x1b, 0x0b, 0x11, 0x01, 0x01,
  0x7f, 0x41, 0xe9, 0xf4, 0x01, 0x21, 0x01, 0x20,
  0x02, 0x20, 0x01, 0x20, 0x00, 0x1b, 0x0b, 0x0d,
  0x01, 0x01, 0x7f, 0x20, 0x00, 0x41, 0x16, 0x6a,
  0x21, 0x01, 0x20, 0x01, 0x0b, 0x0b, 0x01, 0x01,
  0x7f, 0x20, 0x00, 0x41, 0x2c, 0x6a, 0x22, 0x01,
  0x0b, 0x04, 0x00, 0x23, 0x00, 0x0b, 0x08, 0x00,
  0x41, 0x2a, 0x24, 0x01, 0x23, 0x01, 0x0b, 0x11,
  0x00, 0x41, 0xd0, 0x0f, 0x41, 0xd2, 0x09, 0x36,
  0x02, 0x00, 0x41, 0xd0, 0x0f, 0x28, 0x02, 0x00,
  0x0b, 0x14, 0x00, 0x41, 0xd0, 0x0f, 0x42, 0xb1,
  0xd1, 0xf9, 0xd6, 0x03, 0x37, 0x03, 0x00, 0x41,
  0xd0, 0x0f, 0x29, 0x03, 0x00, 0x0b, 0x13, 0x00,
  0x41, 0xb8, 0x17, 0x43, 0xd0, 0x0f, 0x49, 0x40,
  0x38, 0x02, 0x00, 0x41, 0xb8, 0x17, 0x2a, 0x02,
  0x00, 0x0b, 0x17, 0x00, 0x41, 0xa0, 0x1f, 0x44,
  0x6e, 0x86, 0x1b, 0xf0, 0xf9, 0x21, 0x09, 0x40,
  0x39, 0x03, 0x00, 0x41, 0xa0, 0x1f, 0x2b, 0x03,
  0x00, 0x0b, 0x10, 0x00, 0x41, 0xe8, 0x07, 0x20,
  0x00, 0x36, 0x02, 0x00, 0x41, 0xe8, 0x07, 0x2c,
  0x00, 0x00, 0x0b, 0x10, 0x00, 0x41, 0xe8, 0x07,
  0x20, 0x00, 0x36, 0x02, 0x00, 0x41, 0xe8, 0x07,
  0x2d, 0x00, 0x00, 0x0b, 0x10, 0x00, 0x41, 0xe8,
  0x07, 0x20, 0x00, 0x36, 0x02, 0x00, 0x41, 0xe8,
  0x07, 0x2e, 0x01, 0x00, 0x0b, 0x10, 0x00, 0x41,
  0xe8, 0x07, 0x20, 0x00, 0x36, 0x02, 0x00, 0x41,
  0xe8, 0x07, 0x2f, 0x01, 0x00, 0x0b, 0x10, 0x00,
  0x41, 0xe8, 0x07, 0x20, 0x00, 0x37, 0x03, 0x00,
  0x41, 0xe8, 0x07, 0x30, 0x00, 0x00, 0x0b, 0x10,
  0x00, 0x41, 0xe8, 0x07, 0x20, 0x00, 0x37, 0x03,
  0x00, 0x41, 0xe8, 0x07, 0x31, 0x00, 0x00, 0x0b,
  0x10, 0x00, 0x41, 0xe8, 0x07, 0x20, 0x00, 0x37,
  0x03, 0x00, 0x41, 0xe8, 0x07, 0x32, 0x01, 0x00,
  0x0b, 0x10, 0x00, 0x41, 0xe8, 0x07, 0x20, 0x00,
  0x37, 0x03, 0x00, 0x41, 0xe8, 0x07, 0x33, 0x01,
  0x00, 0x0b, 0x10, 0x00, 0x41, 0xe8, 0x07, 0x20,
  0x00, 0x37, 0x03, 0x00, 0x41, 0xe8, 0x07, 0x34,
  0x02, 0x00, 0x0b, 0x10, 0x00, 0x41, 0xe8, 0x07,
  0x20, 0x00, 0x37, 0x03, 0x00, 0x41, 0xe8, 0x07,
  0x35, 0x02, 0x00, 0x0b, 0x10, 0x00, 0x41, 0xe8,
  0x07, 0x20, 0x00, 0x36, 0x02, 0x00, 0x41, 0xe8,
  0x07, 0x28, 0x02, 0x00, 0x0b, 0x10, 0x00, 0x41,
  0xe8, 0x07, 0x20, 0x00, 0x37, 0x03, 0x00, 0x41,
  0xe8, 0x07, 0x29, 0x03, 0x00, 0x0b, 0x10, 0x00,
  0x41, 0xe8, 0x07, 0x20, 0x00, 0x38, 0x02, 0x00,
  0x41, 0xe8, 0x07, 0x2a, 0x02, 0x00, 0x0b, 0x10,
  0x00, 0x41, 0xe8, 0x07, 0x20, 0x00, 0x39, 0x03,
  0x00, 0x41, 0xe8, 0x07, 0x2b, 0x03, 0x00, 0x0b,
  0x10, 0x00, 0x41, 0xe8, 0x07, 0x20, 0x00, 0x3a,
  0x00, 0x00, 0x41, 0xe8, 0x07, 0x28, 0x02, 0x00,
  0x0b, 0x10, 0x00, 0x41, 0xe8, 0x07, 0x20, 0x00,
  0x3b, 0x01, 0x00, 0x41, 0xe8, 0x07, 0x28, 0x02,
  0x00, 0x0b, 0x10, 0x00, 0x41, 0xe8, 0x07, 0x20,
  0x00, 0x3c, 0x00, 0x00, 0x41, 0xe8, 0x07, 0x29,
  0x03, 0x00, 0x0b, 0x10, 0x00, 0x41, 0xe8, 0x07,
  0x20, 0x00, 0x3d, 0x01, 0x00, 0x41, 0xe8, 0x07,
  0x29, 0x03, 0x00, 0x0b, 0x10, 0x00, 0x41, 0xe8,
  0x07, 0x20, 0x00, 0x3e, 0x02, 0x00, 0x41, 0xe8,
  0x07, 0x29, 0x03, 0x00, 0x0b, 0x04, 0x00, 0x3f,
  0x00, 0x0b, 0x06, 0x00, 0x41, 0x01, 0x40, 0x00,
  0x0b, 0x05, 0x00, 0x20, 0x00, 0x45, 0x0b, 0x07,
  0x00, 0x20, 0x00, 0x20, 0x01, 0x46, 0x0b, 0x07,
  0x00, 0x20, 0x00, 0x20, 0x01, 0x47, 0x0b, 0x07,
  0x00, 0x20, 0x00, 0x20, 0x01, 0x48, 0x0b, 0x07,
  0x00, 0x20, 0x00, 0x20, 0x01, 0x49, 0x0b, 0x07,
  0x00, 0x20, 0x00, 0x20, 0x01, 0x4a, 0x0b, 0x07,
  0x00, 0x20, 0x00, 0x20, 0x01, 0x4b, 0x0b, 0x07,
  0x00, 0x20, 0x00, 0x20, 0x01, 0x4c, 0x0b, 0x07,
  0x00, 0x20, 0x00, 0x20, 0x01, 0x4d, 0x0b, 0x07,
  0x00, 0x20, 0x00, 0x20, 0x01, 0x4e, 0x0b, 0x07,
  0x00, 0x20, 0x00, 0x20, 0x01, 0x4f, 0x0b, 0x05,
  0x00, 0x20, 0x00, 0x50, 0x0b, 0x07, 0x00, 0x20,
  0x00, 0x20, 0x01, 0x51, 0x0b, 0x07, 0x00, 0x20,
  0x00, 0x20, 0x01, 0x52, 0x0b, 0x07, 0x00, 0x20,
  0x00, 0x20, 0x01, 0x53, 0x0b, 0x07, 0x00, 0x20,
  0x00, 0x20, 0x01, 0x54, 0x0b, 0x07, 0x00, 0x20,
  0x00, 0x20, 0x01, 0x55, 0x0b, 0x07, 0x00, 0x20,
  0x00, 0x20, 0x01, 0x56, 0x0b, 0x07, 0x00, 0x20,
  0x00, 0x20, 0x01, 0x57, 0x0b, 0x07, 0x00, 0x20,
  0x00, 0x20, 0x01, 0x58, 0x0b, 0x07, 0x00, 0x20,
  0x00, 0x20, 0x01, 0x59, 0x0b, 0x07, 0x00, 0x20,
  0x00, 0x20, 0x01, 0x5a, 0x0b, 0x07, 0x00, 0x20,
  0x00, 0x20, 0x01, 0x5b, 0x0b, 0x07, 0x00, 0x20,
  0x00, 0x20, 0x01, 0x5c, 0x0b, 0x07, 0x00, 0x20,
  0x00, 0x20, 0x01, 0x5d, 0x0b, 0x07, 0x00, 0x20,
  0x00, 0x20, 0x01, 0x5e, 0x0b, 0x07, 0x00, 0x20,
  0x00, 0x20, 0x01, 0x5f, 0x0b, 0x07, 0x00, 0x20,
  0x00, 0x20, 0x01, 0x60, 0x0b, 0x07, 0x00, 0x20,
  0x00, 0x20, 0x01, 0x61, 0x0b, 0x07, 0x00, 0x20,
  0x00, 0x20, 0x01, 0x62, 0x0b, 0x07, 0x00, 0x20,
  0x00, 0x20, 0x01, 0x63, 0x0b, 0x07, 0x00, 0x20,
  0x00, 0x20, 0x01, 0x64, 0x0b, 0x07, 0x00, 0x20,
  0x00, 0x20, 0x01, 0x65, 0x0b, 0x07, 0x00, 0x20,
  0x00, 0x20, 0x01, 0x66, 0x0b, 0x05, 0x00, 0x20,
  0x00, 0x67, 0x0b, 0x05, 0x00, 0x20, 0x00, 0x68,
  0x0b, 0x05, 0x00, 0x20, 0x00, 0x69, 0x0b, 0x07,
  0x00, 0x20, 0x00, 0x20, 0x01, 0x6a, 0x0b, 0x07,
  0x00, 0x20, 0x00, 0x20, 0x01, 0x6b, 0x0b, 0x07,
  0x00, 0x20, 0x00, 0x20, 0x01, 0x6d, 0x0b, 0x07,
  0x00, 0x20, 0x00, 0x20, 0x01, 0x6e, 0x0b, 0x07,
  0x00, 0x20, 0x00, 0x20, 0x01, 0x6f, 0x0b, 0x07,
  0x00, 0x20, 0x00, 0x20, 0x01, 0x70, 0x0b, 0x07,
  0x00, 0x20, 0x00, 0x20, 0x01, 0x71, 0x0b, 0x07,
  0x00, 0x20, 0x00, 0x20, 0x01, 0x72, 0x0b, 0x07,
  0x00, 0x20, 0x00, 0x20, 0x01, 0x73, 0x0b, 0x07,
  0x00, 0x20, 0x00, 0x20, 0x01, 0x74, 0x0b, 0x07,
  0x00, 0x20, 0x00, 0x20, 0x01, 0x75, 0x0b, 0x07,
  0x00, 0x20, 0x00, 0x20, 0x01, 0x76, 0x0b, 0x07,
  0x00, 0x20, 0x00, 0x20, 0x01, 0x77, 0x0b, 0x07,
  0x00, 0x20, 0x00, 0x20, 0x01, 0x78, 0x0b, 0x05,
  0x00, 0x20, 0x00, 0x79, 0x0b, 0x05, 0x00, 0x20,
  0x00, 0x7a, 0x0b, 0x05, 0x00, 0x20, 0x00, 0x7b,
  0x0b, 0x07, 0x00, 0x20, 0x00, 0x20, 0x01, 0x7c,
  0x0b, 0x07, 0x00, 0x20, 0x00, 0x20, 0x01, 0x7d,
  0x0b, 0x07, 0x00, 0x20, 0x00, 0x20, 0x01, 0x7f,
  0x0b, 0x07, 0x00, 0x20, 0x00, 0x20, 0x01, 0x80,
  0x0b, 0x07, 0x00, 0x20, 0x00, 0x20, 0x01, 0x81,
  0x0b, 0x07, 0x00, 0x20, 0x00, 0x20, 0x01, 0x82,
  0x0b, 0x07, 0x00, 0x20, 0x00, 0x20, 0x01, 0x83,
  0x0b, 0x07, 0x00, 0x20, 0x00, 0x20, 0x01, 0x84,
  0x0b, 0x07, 0x00, 0x20, 0x00, 0x20, 0x01, 0x85,
  0x0b, 0x07, 0x00, 0x20, 0x00, 0x20, 0x01, 0x86,
  0x0b, 0x07, 0x00, 0x20, 0x00, 0x20, 0x01, 0x87,
  0x0b, 0x07, 0x00, 0x20, 0x00, 0x20, 0x01, 0x88,
  0x0b, 0x07, 0x00, 0x20, 0x00, 0x20, 0x01, 0x89,
  0x0b, 0x07, 0x00, 0x20, 0x00, 0x20, 0x01, 0x8a,
  0x0b, 0x05, 0x00, 0x20, 0x00, 0x8b, 0x0b, 0x05,
  0x00, 0x20, 0x00, 0x8c, 0x0b, 0x05, 0x00, 0x20,
  0x00, 0x8d, 0x0b, 0x05, 0x00, 0x20, 0x00, 0x8e,
  0x0b, 0x05, 0x00, 0x20, 0x00, 0x8f, 0x0b, 0x05,
  0x00, 0x20, 0x00, 0x90, 0x0b, 0x05, 0x00, 0x20,
  0x00, 0x91, 0x0b, 0x07, 0x00, 0x20, 0x00, 0x20,
  0x01, 0x92, 0x0b, 0x07, 0x00, 0x20, 0x00, 0x20,
  0x01, 0x93, 0x0b, 0x07, 0x00, 0x20, 0x00, 0x20,
  0x01, 0x94, 0x0b, 0x07, 0x00, 0x20, 0x00, 0x20,
  0x01, 0x95, 0x0b, 0x07, 0x00, 0x20, 0x00, 0x20,
  0x01, 0x96, 0x0b, 0x07, 0x00, 0x20, 0x00, 0x20,
  0x01, 0x97, 0x0b, 0x07, 0x00, 0x20, 0x00, 0x20,
  0x01, 0x98, 0x0b, 0x05, 0x00, 0x20, 0x00, 0x99,
  0x0b, 0x05, 0x00, 0x20, 0x00, 0x9a, 0x0b, 0x05,
  0x00, 0x20, 0x00, 0x9b, 0x0b, 0x05, 0x00, 0x20,
  0x00, 0x9c, 0x0b, 0x05, 0x00, 0x20, 0x00, 0x9d,
  0x0b, 0x05, 0x00, 0x20, 0x00, 0x9e, 0x0b, 0x05,
  0x00, 0x20, 0x00, 0x9f, 0x0b, 0x07, 0x00, 0x20,
  0x00, 0x20, 0x01, 0xa0, 0x0b, 0x07, 0x00, 0x20,
  0x00, 0x20, 0x01, 0xa1, 0x0b, 0x07, 0x00, 0x20,
  0x00, 0x20, 0x01, 0xa2, 0x0b, 0x07, 0x00, 0x20,
  0x00, 0x20, 0x01, 0xa3, 0x0b, 0x07, 0x00, 0x20,
  0x00, 0x20, 0x01, 0xa4, 0x0b, 0x07, 0x00, 0x20,
  0x00, 0x20, 0x01, 0xa5, 0x0b, 0x07, 0x00, 0x20,
  0x00, 0x20, 0x01, 0xa6, 0x0b, 0x05, 0x00, 0x20,
  0x00, 0xa7, 0x0b, 0x05, 0x00, 0x20, 0x00, 0xa8,
  0x0b, 0x05, 0x00, 0x20, 0x00, 0xa9, 0x0b, 0x05,
  0x00, 0x20, 0x00, 0xaa, 0x0b, 0x05, 0x00, 0x20,
  0x00, 0xab, 0x0b, 0x05, 0x00, 0x20, 0x00, 0xac,
  0x0b, 0x05, 0x00, 0x20, 0x00, 0xad, 0x0b, 0x05,
  0x00, 0x20, 0x00, 0xae, 0x0b, 0x05, 0x00, 0x20,
  0x00, 0xaf, 0x0b, 0x05, 0x00, 0x20, 0x00, 0xb0,
  0x0b, 0x05, 0x00, 0x20, 0x00, 0xb1, 0x0b, 0x05,
  0x00, 0x20, 0x00, 0xb2, 0x0b, 0x05, 0x00, 0x20,
  0x00, 0xb3, 0x0b, 0x05, 0x00, 0x20, 0x00, 0xb4,
  0x0b, 0x05, 0x00, 0x20, 0x00, 0xb5, 0x0b, 0x05,
  0x00, 0x20, 0x00, 0xb6, 0x0b, 0x05, 0x00, 0x20,
  0x00, 0xb7, 0x0b, 0x05, 0x00, 0x20, 0x00, 0xb8,
  0x0b, 0x05, 0x00, 0x20, 0x00, 0xb9, 0x0b, 0x05,
  0x00, 0x20, 0x00, 0xba, 0x0b, 0x05, 0x00, 0x20,
  0x00, 0xbb, 0x0b, 0x05, 0x00, 0x20, 0x00, 0xbc,
  0x0b, 0x05, 0x00, 0x20, 0x00, 0xbd, 0x0b, 0x05,
  0x00, 0x20, 0x00, 0xbe, 0x0b, 0x05, 0x00, 0x20,
  0x00, 0xbf, 0x0b, 0x05, 0x00, 0x20, 0x00, 0xc0,
  0x0b, 0x05, 0x00, 0x20, 0x00, 0xc1, 0x0b, 0x05,
  0x00, 0x20, 0x00, 0xc2, 0x0b, 0x05, 0x00, 0x20,
  0x00, 0xc3, 0x0b, 0x05, 0x00, 0x20, 0x00, 0xc4,
  0x0b, 0x06, 0x00, 0x20, 0x00, 0xfc, 0x00, 0x0b,
  0x06, 0x00, 0x20, 0x00, 0xfc, 0x01, 0x0b, 0x06,
  0x00, 0x20, 0x00, 0xfc, 0x02, 0x0b, 0x06, 0x00,
  0x20, 0x00, 0xfc, 0x03, 0x0b, 0x06, 0x00, 0x20,
  0x00, 0xfc, 0x04, 0x0b, 0x06, 0x00, 0x20, 0x00,
  0xfc, 0x05, 0x0b, 0x06, 0x00, 0x20, 0x00, 0xfc,
  0x06, 0x0b, 0x06, 0x00, 0x20, 0x00, 0xfc, 0x07,
  0x0b
};

static const struct {
  const char * const name;
  const pwasm_buf_t data;
} TEST_BLOBS[] = {{
  .name = "guide",
  .data = { GUIDE_WASM, sizeof(GUIDE_WASM) },
}, {
  .name = "pythag",
  .data = { PYTHAG_WASM, sizeof(PYTHAG_WASM) },
}, {
  .name = "fib",
  .data = { FIB_WASM, sizeof(FIB_WASM) },
}, {
  .name = "vec",
  .data = { VEC_WASM, sizeof(VEC_WASM) },
}, {
  .name = "mem",
  .data = { MEM_WASM, sizeof(MEM_WASM) },
}, {
  .name = "global",
  .data = { GLOBAL_WASM, sizeof(GLOBAL_WASM) },
}, {
  .name = "br_table",
  .data = { BR_TABLE_WASM, sizeof(BR_TABLE_WASM) },
}, {
  .name = "call_indirect",
  .data = { CALL_INDIRECT_WASM, sizeof(CALL_INDIRECT_WASM) },
}, {
  .name = "v128-const",
  .data = { V128_CONST_WASM, sizeof(V128_CONST_WASM) },
}, {
  .name = "start",
  .data = { START_WASM, sizeof(START_WASM) },
}, {
  .name = "ops",
  .data = { OPS_WASM, sizeof(OPS_WASM) },
}};

static const pwasm_val_t
TEST_VALS[] = {
  // mod: "native", func: "add_one", test: 1, type: "params", num: 1
  { .i32 = 3 },

  // mod: "native", func: "add_one", test: 1, type: "result", num: 1
  { .i32 = 4 },

  // mod: "native", func: "add_two", test: 1, type: "params", num: 2
  { .i32 = 3 },
  { .i32 = 4 },

  // mod: "native", func: "add_two", test: 1, type: "result", num: 1
  { .i32 = 12 },

  // mod: "guide", func: "life", test: 1, type: "params", num: 0

  // mod: "guide", func: "life", test: 1, type: "result", num: 1
  { .i32 = 42 },

  // mod: "pythag", func: "f32.pythag", test: 1, type: "params", num: 2
  { .f32 = 3.0f },
  { .f32 = 4.0f },

  // mod: "pythag", func: "f32.pythag", test: 1, type: "result", num: 1
  { .f32 = 5.0f },

  // mod: "pythag", func: "f64.pythag", test: 1, type: "params", num: 2
  { .f64 = 5.0f },
  { .f64 = 6.0f },

  // mod: "pythag", func: "f64.pythag", test: 1, type: "result", num: 1
  { .f64 = 7.810250f },

  // mod: "fib", func: "fib_recurse", test: 1, type: "params", num: 1
  { .i32 = 3 },

  // mod: "fib", func: "fib_recurse", test: 1, type: "result", num: 1
  { .i32 = 2 },

  // mod: "fib", func: "fib_recurse", test: 2, type: "params", num: 1
  { .i32 = 5 },

  // mod: "fib", func: "fib_recurse", test: 2, type: "result", num: 1
  { .i32 = 5 },

  // mod: "fib", func: "fib_iterate", test: 1, type: "params", num: 1
  { .i32 = 3 },

  // mod: "fib", func: "fib_iterate", test: 1, type: "result", num: 1
  { .i32 = 2 },

  // mod: "fib", func: "fib_iterate", test: 2, type: "params", num: 1
  { .i32 = 5 },

  // mod: "fib", func: "fib_iterate", test: 2, type: "result", num: 1
  { .i32 = 5 },

  // mod: "mem", func: "set", test: 1, type: "params", num: 2
  { .i32 = 0 },
  { .i32 = 3141 },

  // mod: "mem", func: "set", test: 1, type: "result", num: 1
  { .i32 = 3141 },

  // mod: "mem", func: "set", test: 2, type: "params", num: 2
  { .i32 = 4 },
  { .i32 = 5926 },

  // mod: "mem", func: "set", test: 2, type: "result", num: 1
  { .i32 = 5926 },

  // mod: "mem", func: "get", test: 1, type: "params", num: 1
  { .i32 = 0 },

  // mod: "mem", func: "get", test: 1, type: "result", num: 1
  { .i32 = 3141 },

  // mod: "mem", func: "get", test: 2, type: "params", num: 1
  { .i32 = 4 },

  // mod: "mem", func: "get", test: 2, type: "result", num: 1
  { .i32 = 5926 },

  // mod: "global", func: "i32.set", test: 1, type: "params", num: 1
  { .i32 = 27 },

  // mod: "global", func: "i32.get", test: 2, type: "result", num: 1
  { .i32 = 27 },

  // mod: "global", func: "i64.set", test: 1, type: "params", num: 1
  { .i64 = 31415926535987 },

  // mod: "global", func: "i64.get", test: 2, type: "result", num: 1
  { .i64 = 31415926535987 },

  // mod: "global", func: "f32.set", test: 1, type: "params", num: 1
  { .f32 = 3.14159 },

  // mod: "global", func: "f32.get", test: 2, type: "result", num: 1
  { .f32 = 3.14159 },

  // mod: "global", func: "f64.set", test: 1, type: "params", num: 1
  { .f64 = 2.718281 },

  // mod: "global", func: "f64.get", test: 2, type: "result", num: 1
  { .f64 = 2.718281 },

  // mod: "br_table", func: "add_nth", test: 0, type: "params", num: 2
  { .i32 = 0 },
  { .i32 = 0 },

  // mod: "br_table", func: "add_nth", test: 0, type: "result", num: 1
  { .i32 = 21 },

  // mod: "br_table", func: "add_nth", test: 1, type: "params", num: 2
  { .i32 = 3 },
  { .i32 = 0 },

  // mod: "br_table", func: "add_nth", test: 1, type: "result", num: 1
  { .i32 = 24 },

  // mod: "call_indirect", func: "i32_map", test: 0, type: "params", num: 2
  { .i32 = 5 },
  { .i32 = 0 },

  // mod: "call_indirect", func: "i32_map", test: 0, type: "result", num: 1
  { .i32 = 10 },

  // mod: "call_indirect", func: "i32_map", test: 1, type: "params", num: 2
  { .i32 = 33 },
  { .i32 = 1 },

  // mod: "call_indirect", func: "i32_map", test: 1, type: "result", num: 1
  { .i32 = 99 },

  // mod: "call_indirect", func: "i32_map", test: 2, type: "params", num: 2
  { .i32 = 9 },
  { .i32 = 2 },

  // mod: "call_indirect", func: "i32_map", test: 2, type: "result", num: 1
  { .i32 = 81 },

  // mod: "call_indirect", func: "i32_map", test: 3, type: "params", num: 2
  { .i32 = 7 },
  { .i32 = 3 },

  // mod: "call_indirect", func: "i32_map", test: 3, type: "result", num: 1
  { .i32 = 343 },

  // mod: "call_indirect", func: "f32_map", test: 0, type: "params", num: 2
  { .f32 = 5 },
  { .i32 = 4 },

  // mod: "call_indirect", func: "f32_map", test: 0, type: "result", num: 1
  { .f32 = 10 },

  // mod: "call_indirect", func: "f32_map", test: 1, type: "params", num: 2
  { .f32 = 33 },
  { .i32 = 5 },

  // mod: "call_indirect", func: "f32_map", test: 1, type: "result", num: 1
  { .f32 = 99 },

  // mod: "call_indirect", func: "f32_map", test: 2, type: "params", num: 2
  { .f32 = 9 },
  { .i32 = 6 },

  // mod: "call_indirect", func: "f32_map", test: 2, type: "result", num: 1
  { .f32 = 81 },

  // mod: "call_indirect", func: "f32_map", test: 3, type: "params", num: 2
  { .f32 = 7 },
  { .i32 = 7 },

  // mod: "call_indirect", func: "f32_map", test: 3, type: "result", num: 1
  { .f32 = 343 },

  // mod: "v128-const", func: "i8x16_add", test: 0, type: "params", num: 1
  { .i32 = 17 },

  // mod: "v128-const", func: "i8x16_add", test: 0, type: "result", num: 1
  { .i32 = 20 },

  // mod: "start", func: "get", test: 0, type: "result", num: 1
  { .i32 = 42 },

  // mod: "ops", func: "test_nop", test: 0, type: "result", num: 1
  { .i32 = 1234 },

  // mod: "ops", func: "test_block", test: 0, type: "result", num: 1
  { .i32 = 34 },

  // mod: "ops", func: "test_loop", test: 0, type: "result", num: 1
  { .i32 = 5 },

  // mod: "ops", func: "test_if_else", test: 0, type: "params", num: 1
  { .i32 = 99 },

  // mod: "ops", func: "test_if_else", test: 0, type: "result", num: 1
  { .i32 = 33 },

  // mod: "ops", func: "test_if_else", test: 1, type: "params", num: 1
  { .i32 = 100 },

  // mod: "ops", func: "test_if_else", test: 1, type: "result", num: 1
  { .i32 = 22 },

  // mod: "ops", func: "test_call", test: 1, type: "result", num: 1
  { .i32 = 55 },
};

typedef struct {
  const char * const text;
  const char * const mod;
  const char * const func;
  const pwasm_slice_t params;
  const pwasm_slice_t result;
  const pwasm_result_type_t type;
} wasm_test_call_t;

static const wasm_test_call_t
TEST_CALLS[] = {{
  .text   = "guide.life()",
  .mod    = "guide",
  .func   = "life",
  .params = { 0, 0 },
  .result = { 5, 1 },
  .type   = PWASM_RESULT_TYPE_I32,
}, {
  .text   = "pythag.f32.pythag(3, 4)",
  .mod    = "pythag",
  .func   = "f32.pythag",
  .params = { 6, 2 },
  .result = { 8, 1 },
  .type   = PWASM_RESULT_TYPE_F32,
}, {
  .text   = "pythag.f64.pythag(5, 6)",
  .mod    = "pythag",
  .func   = "f64.pythag",
  .params = { 9, 2 },
  .result = { 11, 1 },
  .type   = PWASM_RESULT_TYPE_F64,
}, {
  .text   = "fib.fib_recurse(3)",
  .mod    = "fib",
  .func   = "fib_recurse",
  .params = { 12, 1 },
  .result = { 13, 1 },
  .type   = PWASM_RESULT_TYPE_I32,
}, {
  .text   = "fib.fib_recurse(4)",
  .mod    = "fib",
  .func   = "fib_recurse",
  .params = { 14, 1 },
  .result = { 15, 1 },
  .type   = PWASM_RESULT_TYPE_I32,
}, {
  .text   = "fib.fib_iterate(3)",
  .mod    = "fib",
  .func   = "fib_recurse",
  .params = { 16, 1 },
  .result = { 17, 1 },
  .type   = PWASM_RESULT_TYPE_I32,
}, {
  .text   = "fib.fib_iterate(4)",
  .mod    = "fib",
  .func   = "fib_iterate",
  .params = { 18, 1 },
  .result = { 19, 1 },
  .type   = PWASM_RESULT_TYPE_I32,
}, {
  .text   = "mem.set(0, 3141)",
  .mod    = "mem",
  .func   = "set",
  .params = { 20, 2 },
  .result = { 22, 1 },
  .type   = PWASM_RESULT_TYPE_I32,
}, {
  .text   = "mem.set(4, 5926)",
  .mod    = "mem",
  .func   = "set",
  .params = { 23, 2 },
  .result = { 25, 1 },
  .type   = PWASM_RESULT_TYPE_I32,
}, {
  .text   = "mem.get(0)",
  .mod    = "mem",
  .func   = "get",
  .params = { 26, 1 },
  .result = { 27, 1 },
  .type   = PWASM_RESULT_TYPE_I32,
}, {
  .text   = "mem.get(4)",
  .mod    = "mem",
  .func   = "get",
  .params = { 28, 1 },
  .result = { 29, 1 },
  .type   = PWASM_RESULT_TYPE_I32,
}, {
  .text   = "global.i32.set(27)",
  .mod    = "global",
  .func   = "i32.set",
  .params = { 30, 1 },
  .type   = PWASM_RESULT_TYPE_VOID,
}, {
  .text   = "global.i32.get()",
  .mod    = "global",
  .func   = "i32.get",
  .result = { 31, 1 },
  .type   = PWASM_RESULT_TYPE_I32,
}, {
  .text   = "global.i64.set(31415926535987)",
  .mod    = "global",
  .func   = "i64.set",
  .params = { 32, 1 },
  .type   = PWASM_RESULT_TYPE_VOID,
}, {
  .text   = "global.i64.get()",
  .mod    = "global",
  .func   = "i64.get",
  .result = { 33, 1 },
  .type   = PWASM_RESULT_TYPE_I64,
}, {
  .text   = "global.f32.set(3.14159)",
  .mod    = "global",
  .func   = "f32.set",
  .params = { 34, 1 },
  .type   = PWASM_RESULT_TYPE_VOID,
}, {
  .text   = "global.f32.get()",
  .mod    = "global",
  .func   = "f32.get",
  .result = { 35, 1 },
  .type   = PWASM_RESULT_TYPE_F32,
}, {
  .text   = "global.f64.set(2.718281)",
  .mod    = "global",
  .func   = "f64.set",
  .params = { 36, 1 },
  .type   = PWASM_RESULT_TYPE_VOID,
}, {
  .text   = "global.f64.get()",
  .mod    = "global",
  .func   = "f64.get",
  .result = { 37, 1 },
  .type   = PWASM_RESULT_TYPE_F64,
}, {
  .text   = "br_table.add_nth(0, 0)",
  .mod    = "br_table",
  .func   = "add_nth",
  .params = { 38, 2 },
  .result = { 40, 1 },
  .type   = PWASM_RESULT_TYPE_I32,
}, {
  .text   = "br_table.add_nth(3, 0)",
  .mod    = "br_table",
  .func   = "add_nth",
  .params = { 41, 2 },
  .result = { 43, 1 },
  .type   = PWASM_RESULT_TYPE_I32,
}, {
  .text   = "call_indirect.i32_map(5, 0)",
  .mod    = "call_indirect",
  .func   = "i32_map",
  .params = { 44, 2 },
  .result = { 46, 1 },
  .type   = PWASM_RESULT_TYPE_I32,
}, {
  .text   = "call_indirect.i32_map(33, 1)",
  .mod    = "call_indirect",
  .func   = "i32_map",
  .params = { 47, 2 },
  .result = { 49, 1 },
  .type   = PWASM_RESULT_TYPE_I32,
}, {
  .text   = "call_indirect.i32_map(9, 2)",
  .mod    = "call_indirect",
  .func   = "i32_map",
  .params = { 50, 2 },
  .result = { 52, 1 },
  .type   = PWASM_RESULT_TYPE_I32,
}, {
  .text   = "call_indirect.i32_map(7, 3)",
  .mod    = "call_indirect",
  .func   = "i32_map",
  .params = { 53, 2 },
  .result = { 55, 1 },
  .type   = PWASM_RESULT_TYPE_I32,
}, {
  .text   = "call_indirect.f32_map(5, 0)",
  .mod    = "call_indirect",
  .func   = "f32_map",
  .params = { 56, 2 },
  .result = { 58, 1 },
  .type   = PWASM_RESULT_TYPE_F32,
}, {
  .text   = "call_indirect.f32_map(33, 1)",
  .mod    = "call_indirect",
  .func   = "f32_map",
  .params = { 59, 2 },
  .result = { 61, 1 },
  .type   = PWASM_RESULT_TYPE_F32,
}, {
  .text   = "call_indirect.f32_map(9, 2)",
  .mod    = "call_indirect",
  .func   = "f32_map",
  .params = { 62, 2 },
  .result = { 64, 1 },
  .type   = PWASM_RESULT_TYPE_F32,
}, {
  .text   = "call_indirect.f32_map(7, 3)",
  .mod    = "call_indirect",
  .func   = "f32_map",
  .params = { 65, 2 },
  .result = { 67, 1 },
  .type   = PWASM_RESULT_TYPE_F32,
}, {
  .text   = "v128-const.i8x16_add(7, 3)",
  .mod    = "v128-const",
  .func   = "i8x16_add",
  .params = { 68, 1 },
  .result = { 69, 1 },
  .type   = PWASM_RESULT_TYPE_I32,
}, {
  .text   = "start.get()",
  .mod    = "start",
  .func   = "get",
  .result = { 70, 1 },
  .type   = PWASM_RESULT_TYPE_I32,
}, {
  .text   = "ops.test_nop()",
  .mod    = "ops",
  .func   = "test_nop",
  .result = { 71, 1 },
  .type   = PWASM_RESULT_TYPE_I32,
}, {
  .text   = "ops.test_block()",
  .mod    = "ops",
  .func   = "test_block",
  .result = { 72, 1 },
  .type   = PWASM_RESULT_TYPE_I32,
}, {
  .text   = "ops.test_loop()",
  .mod    = "ops",
  .func   = "test_loop",
  .result = { 73, 1 },
  .type   = PWASM_RESULT_TYPE_I32,
}, {
  .text   = "ops.test_if_else()",
  .mod    = "ops",
  .func   = "test_if_else",
  .params = { 74, 1 },
  .result = { 75, 1 },
  .type   = PWASM_RESULT_TYPE_I32,
}, {
  .text   = "ops.test_if_else()",
  .mod    = "ops",
  .func   = "test_if_else",
  .params = { 76, 1 },
  .result = { 77, 1 },
  .type   = PWASM_RESULT_TYPE_I32,
}, {
  .text   = "ops.test_call()",
  .mod    = "ops",
  .func   = "test_call",
  .result = { 78, 1 },
  .type   = PWASM_RESULT_TYPE_I32,
}};

static bool is_valid_result_type(
  const pwasm_result_type_t type
) {
  return (
    (type == PWASM_RESULT_TYPE_I32) ||
    (type == PWASM_RESULT_TYPE_I64) ||
    (type == PWASM_RESULT_TYPE_F32) ||
    (type == PWASM_RESULT_TYPE_F64) ||
    (type == PWASM_RESULT_TYPE_VOID)
  );
}

/**
 * get the name of a result check of a wasm_test_call_t
 */
static void get_result_check_name(
  char * const buf, // dest buf
  const size_t buf_len, // dest buf len
  const wasm_test_call_t test // source test
) {
  // build result assertion name
  snprintf(buf, buf_len, "check result (%s) of pwasm_call(&env, \"%s\", \"%s\")", pwasm_result_type_get_name(test.type), test.mod, test.func);
}

/**
 * check test result value.
 *
 * if the result value matches the expected result, then return true.
 *
 * if the result value does not match the expected result, then print a
 * description of the failure to buf and return false.
 */
static bool check_result(
  const wasm_test_call_t test,
  const pwasm_stack_t * const stack,
  char * dst_buf,
  const size_t dst_buf_len
) {
  const pwasm_val_t got_val = stack->pos ? stack->ptr[stack->pos - 1] : ((pwasm_val_t) { .i32 = 0 });
  const pwasm_val_t exp_val = TEST_VALS[test.result.ofs];
  char buf[64] = { 0 };
  bool r = false;

  if (test.type == PWASM_RESULT_TYPE_VOID) {
    r = (stack->pos == 0);
    if (!r) {
      snprintf(buf, sizeof(buf), "stack->pos: expected 0, got %zu", stack->pos);
    }
  } else if (stack->pos != 1) {
    snprintf(buf, sizeof(buf), "stack->pos: expected 1, got %zu", stack->pos);
  } else {
    switch (test.type) {
    case PWASM_RESULT_TYPE_I32:
      r = (got_val.i32 == exp_val.i32);
      if (!r) {
        // build error
        snprintf(buf, sizeof(buf), "expected %u, got %u", exp_val.i32, got_val.i32);
      }

      break;
    case PWASM_RESULT_TYPE_I64:
      r = (got_val.i64 == exp_val.i64);
      if (!r) {
        // build error
        snprintf(buf, sizeof(buf), "expected %lu, got %lu", exp_val.i64, got_val.i64);
      }

      break;
    case PWASM_RESULT_TYPE_F32:
      r = NEARLY_EQUAL(got_val.f32, exp_val.f32);
      if (!r) {
        // build error
        snprintf(buf, sizeof(buf), "expected %f, got %f", exp_val.f32, got_val.f32);
      }

      break;
    case PWASM_RESULT_TYPE_F64:
      r = NEARLY_EQUAL(got_val.f64, exp_val.f64);
      if (!r) {
        // build error
        snprintf(buf, sizeof(buf), "expected %f, got %f", exp_val.f32, got_val.f32);
      }

      break;
    default:
      // never reached
      snprintf(buf, sizeof(buf), "unknown result type: %u", test.type);
    }
  }

  if (!r) {
    // populate destination buffer
    snprintf(dst_buf, dst_buf_len, "check result (%s) of pwasm_call(&env, \"%s\", \"%s\"): %s", pwasm_result_type_get_name(test.type), test.mod, test.func, buf);
  }

  // return result
  return r;
}

void test_wasm_calls(
  cli_test_ctx_t * const test_ctx,
  const cli_test_t * const cli_test
) {
  char buf[1024];

  // create a memory context
  pwasm_mem_ctx_t mem_ctx = pwasm_mem_ctx_init_defaults(NULL);

  // set up stack
  pwasm_val_t stack_vals[MAX_STACK_DEPTH];
  pwasm_stack_t stack = {
    .ptr = stack_vals,
    .len = MAX_STACK_DEPTH,
  };

  // get interpreter callbacks
  const pwasm_env_cbs_t * const cbs = pwasm_new_interpreter_get_cbs();

  // create environment, check for error
  pwasm_env_t env;
  if (!pwasm_env_init(&env, &mem_ctx, cbs, &stack, NULL)) {
    cli_test_error(test_ctx, "pwasm_env_init() failed");
  }

  // parse and add wasms
  pwasm_mod_t mods[LEN(TEST_BLOBS)];
  for (size_t i = 0; i < LEN(TEST_BLOBS); i++) {
    // get name and data
    const char * const name = TEST_BLOBS[i].name;
    pwasm_buf_t tmp_buf = TEST_BLOBS[i].data;

    // parse blob into mod, check for error
    if (!pwasm_mod_init(&mem_ctx, &(mods[i]), tmp_buf)) {
      snprintf(buf, sizeof(buf), "%s.wasm: pwasm_mod_init() failed", name);
      cli_test_error(test_ctx, buf);
    }

    // add mod to env, check for error
    if (!pwasm_env_add_mod(&env, name, &(mods[i]))) {
      snprintf(buf, sizeof(buf), "%s: pwasm_env_add_mod() failed", name);
      cli_test_error(test_ctx, buf);
    }
  }

  for (size_t i = 0; i < LEN(TEST_CALLS); i++) {
    // get test
    const wasm_test_call_t test = TEST_CALLS[i];

    // check for valid test type
    if (!is_valid_result_type(test.type)) {
      snprintf(buf, sizeof(buf), "pwasm_call(&env, \"%s\", \"%s\") result: unknown test result type: %u", test.mod, test.func, test.type);
      cli_test_error(test_ctx, buf);
    }

    // populate stack
    stack.pos = test.params.len;
    if (test.params.len > 0) {
      const size_t num_bytes = sizeof(pwasm_val_t) * test.params.len;
      memcpy(stack.ptr, TEST_VALS + test.params.ofs, num_bytes);
    }

    // build assertion name
    snprintf(buf, sizeof(buf), "call pwasm_call(&env, \"%s\", \"%s\")", test.mod, test.func);

    // invoke function
    const bool call_ok = pwasm_call(&env, test.mod, test.func);

    // check pwasm_call() result
    if (call_ok) {
      // pass assertion
      cli_test_pass(test_ctx, cli_test, buf);
    } else {
      // fail assertion
      cli_test_fail(test_ctx, cli_test, buf);
    }

    if (call_ok) {
      // call passed, check result value
      if (check_result(test, &stack, buf, sizeof(buf))) {
        // result check passed, log pass
        get_result_check_name(buf, sizeof(buf), test);
        cli_test_pass(test_ctx, cli_test, buf);
      } else {
        // result check failed, log fail
        cli_test_fail(test_ctx, cli_test, buf);
      }
    } else {
      // call failed, so log unconditional result check fail
      get_result_check_name(buf, sizeof(buf), test);
      cli_test_fail(test_ctx, cli_test, buf);
    }
  }

  // finalize environment
  pwasm_env_fini(&env);
}
